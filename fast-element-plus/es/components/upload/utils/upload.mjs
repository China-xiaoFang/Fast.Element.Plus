import{ElMessage as e}from"element-plus";import"../../../constants/index.mjs";import{consoleError as t,consoleWarn as r}from"@fast-china/utils";import{isFunction as o,isArray as a}from"lodash-unified";import{FaMimeType as i}from"../../../constants/mime.mjs";const n={};for(const[p,c]of Object.entries(i))c.split(",").forEach(e=>{n[e.trim()]=p});const s={detectFileType(e){const t=/* @__PURE__ */new Set;return e.split(",").forEach(e=>{t.add(n[e]??e)}),Array.from(t).join(",")},getPropsData(e,t){let r;r=o(t)?t(e):t;const i={};return a(t)?t.forEach(e=>{Object.assign(i,e)}):Object.assign(i,r),i},async uploadFile(o,a,i,n){if(!o)return t("uploadUtil","文件上传地址为空！"),e.error("文件上传地址为空！"),Promise.reject();const s=new FormData;s.append("file",a),s.append("fileName",i),n&&Object.keys(n).forEach(e=>{s.append(e,n[e])});try{const t=await fetch(o,{headers:{"Content-Type":"multipart/form-data"},method:"POST",body:s});return t.ok?await t.text():(r("uploadUtil","文件上传失败！"),e.error("文件上传失败！"),Promise.reject())}catch(p){return r("uploadUtil","文件上传失败！"),t("uploadUtil",p),e.error("文件上传失败！"),Promise.reject()}},async uploadFileByApi(o,a,i,n){if(!o)return t("uploadUtil","文件上传接口为空！"),e.error("文件上传接口为空！"),Promise.reject();const s=new FormData;s.append("file",a),s.append("fileName",i),n&&Object.keys(n).forEach(e=>{s.append(e,n[e])});try{return Promise.resolve(await o(s))}catch(p){return r("uploadUtil","文件上传失败！"),t("uploadUtil",p),e.error("文件上传失败！"),Promise.reject()}}};export{s as uploadUtil};
//# sourceMappingURL=upload.mjs.map
