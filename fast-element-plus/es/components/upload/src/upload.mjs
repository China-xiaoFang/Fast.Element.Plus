import{defineComponent as e,computed as l,ref as a,withDirectives as t,createVNode as i,mergeProps as o,Fragment as u,createTextVNode as n,resolveDirective as s}from"vue";import{uploadProps as d,ElUpload as r,ElIcon as p}from"element-plus";import{UploadFilled as m}from"@element-plus/icons-vue";import{definePropType as f,useProps as c,useRender as h,useExpose as v,makeSlots as g}from"@fast-china/utils";import{isString as x,isArray as S,isNull as b}from"lodash-unified";import{useUpload as U}from"./useUpload.mjs";const L={...d,drag:{type:Boolean,default:!0},limit:{type:Number,default:1},modelValue:f([String,Array]),maxSize:{type:f([String,Number]),default:5120},uploadApi:{type:f(Function)},uploadUrl:String},y={"update:modelValue":e=>x(e)||S(e)||b(e),"update:fileList":e=>S(e),change:e=>x(e)||S(e)||b(e)},E=/* @__PURE__ */e({name:"FaUpload",props:L,emits:y,slots:g(),setup(e,{attrs:f,slots:g,emit:x,expose:S}){const{fileList:b,loading:L,formContext:y,maxSizeMB:E,handleHttpRequest:F,handleOnSuccess:_,handleOnError:z,handleOnExceed:C,handleOnUpload:R}=U("FaUpload","文件",e,x,{maxSize:e.maxSize,uploadApi:e.uploadApi,uploadUrl:e.uploadUrl}),A=l(()=>e.disabled||y?.disabled),O=a(),q=(l,a)=>{"ready"===l.status&&(R(l)?e.onChange&&e.onChange(l,a):b.value=b.value.slice(0,-1))},B=c(e,d,["fileList","disabled","httpRequest","onExceed","onSuccess","onError","onChange"]);return h(()=>t(i(r,o(B.value,{ref:O,class:"fa-upload",fileList:b.value,"onUpdate:fileList":e=>b.value=e,disabled:A.value,httpRequest:F,onExceed:C,onSuccess:_,onError:z,onChange:q}),{default:()=>g.default?g.default():i(u,null,[i(p,{class:"el-icon--upload"},{default:()=>[i(m,null,null)]}),i("div",{class:"el-upload__text"},[n("Drop file here or "),i("em",null,[n("click to upload")])])]),...g.trigger&&{trigger:()=>g.trigger()},tip:()=>g.tip?g.tip():i(u,null,[i("div",{class:"el-upload__tip"},[n("files with a size less than "),E.toString(),n("MB")]),!e.showFileList&&b.value.length>0&&i("div",{class:"el-upload__tip"},[b.value.map((e,l)=>i(u,null,[e.name,b.value.length<=l&&i("br",null,null)]))])]),...g.file&&{file:({file:e,index:l})=>g.file({file:e,index:l})}}),[[s("loading"),L.value]])),v(S,{abort:l(()=>O.value?.abort),submit:l(()=>O.value?.submit),clearFiles:l(()=>O.value?.clearFiles),handleStart:l(()=>O.value?.handleStart),handleRemove:l(()=>O.value?.handleRemove),loading:L,fileList:b})}});export{E as default,y as faUploadEmits,L as faUploadProps};
//# sourceMappingURL=upload.mjs.map
