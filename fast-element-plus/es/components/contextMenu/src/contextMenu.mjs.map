{"version":3,"file":"contextMenu.mjs","sources":["../../../../../packages/components/contextMenu/src/contextMenu.tsx"],"sourcesContent":["import { Transition, computed, defineComponent, onMounted, reactive } from \"vue\";\nimport { useGlobalSize } from \"element-plus\";\nimport { FaIcon } from \"@fast-element-plus/components/icon\";\nimport { definePropType, useExpose, useRender } from \"@fast-china/utils\";\nimport { useEventListener } from \"@vueuse/core\";\nimport { isObject } from \"lodash-unified\";\nimport type { FaContextMenuData } from \"./contextMenu.type\";\n\nexport default defineComponent({\n\tname: \"FaContextMenu\",\n\tprops: {\n\t\t/** @description 数据 */\n\t\tdata: {\n\t\t\ttype: definePropType<FaContextMenuData[]>(Array),\n\t\t\tdefault: () => [],\n\t\t},\n\t},\n\temits: {\n\t\t/** @description 点击事件 */\n\t\tclick: (event: MouseEvent, data: FaContextMenuData) => event instanceof MouseEvent && isObject(data),\n\t},\n\tsetup(props, { emit, expose }) {\n\t\tconst _globalSize = useGlobalSize();\n\n\t\tconst state = reactive({\n\t\t\tvisible: false,\n\t\t\taxis: {\n\t\t\t\tx: 0,\n\t\t\t\ty: 0,\n\t\t\t},\n\t\t});\n\n\t\tconst handleClick = (event: MouseEvent, data: FaContextMenuData): void => {\n\t\t\tif (data?.disabled) return;\n\t\t\tdata?.click && data.click(event, data);\n\t\t\temit(\"click\", event, data);\n\t\t};\n\n\t\tconst open = (axis: { x: number; y: number } = { x: 0, y: 0 }): void => {\n\t\t\tstate.axis = axis;\n\t\t\tstate.visible = true;\n\t\t};\n\n\t\tconst close = (): void => {\n\t\t\tstate.visible = false;\n\t\t};\n\n\t\tonMounted(() => {\n\t\t\tuseEventListener(document, \"click\", close);\n\t\t});\n\n\t\tuseRender(() => (\n\t\t\t<Transition name=\"el-zoom-in-center\">\n\t\t\t\t<div\n\t\t\t\t\tclass={[\"fa-context-menu\", `fa-context-menu-${_globalSize.value}`, \"el-popper el-dropdown__popper\"]}\n\t\t\t\t\tstyle={{ top: `${state.axis.y + 5}px`, left: `${state.axis.x + 14}px` }}\n\t\t\t\t\tvShow={state.visible}\n\t\t\t\t\tkey={Math.random()}\n\t\t\t\t>\n\t\t\t\t\t<ul class=\"el-dropdown-menu\">\n\t\t\t\t\t\t{props.data\n\t\t\t\t\t\t\t.filter((f) => !f.hide)\n\t\t\t\t\t\t\t.map((item) => (\n\t\t\t\t\t\t\t\t<li\n\t\t\t\t\t\t\t\t\tclass={[\"el-dropdown-menu__item\", item?.disabled === true ? \"is-disabled\" : \"\"]}\n\t\t\t\t\t\t\t\t\ttabIndex=\"-1\"\n\t\t\t\t\t\t\t\t\tonClick={(event: MouseEvent) => {\n\t\t\t\t\t\t\t\t\t\thandleClick(event, item);\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{item?.icon ? <FaIcon name={item?.icon} /> : null}\n\t\t\t\t\t\t\t\t\t<span>{item.label}</span>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t</Transition>\n\t\t));\n\n\t\treturn useExpose(expose, {\n\t\t\t/** @description 是否显示 */\n\t\t\tvisible: computed(() => state.visible),\n\t\t\t/** @description 打开菜单 */\n\t\t\topen,\n\t\t\t/** @description 关闭菜单 */\n\t\t\tclose,\n\t\t});\n\t},\n});\n"],"names":["name","props","data","type","definePropType","Array","default","emits","click","event","MouseEvent","isObject","setup","emit","expose","_globalSize","useGlobalSize","state","reactive","visible","axis","x","y","handleClick","disabled","open","close","onMounted","useEventListener","document","useRender","_createVNode","Transition","_withDirectives","value","top","left","Math","random","filter","f","hide","map","item","icon","FaIcon","label","_vShow","useExpose","computed"],"mappings":";;;;;;AAQA,MAAA,8CAA+B;AAAA,EAC9BA,MAAM;AAAA,EACNC,OAAO;AAAA;AAAA,IAENC,MAAM;AAAA,MACLC,MAAMC,eAAoCC,KAAK;AAAA,MAC/CC,SAASA,MAAM,CAAA;AAAA,IAChB;AAAA;EAEDC,OAAO;AAAA;AAAA,IAENC,OAAOA,CAACC,OAAmBP,SAA4BO,iBAAiBC,cAAcC,SAAST,IAAI;AAAA;EAEpGU,MAAMX,OAAO;AAAA,IAAEY;AAAAA,IAAMC;AAAAA,EAAO,GAAG;AAC9B,UAAMC,cAAcC,cAAa;AAEjC,UAAMC,QAAQC,SAAS;AAAA,MACtBC,SAAS;AAAA,MACTC,MAAM;AAAA,QACLC,GAAG;AAAA,QACHC,GAAG;AAAA,MACJ;AAAA,IACD,CAAC;AAED,UAAMC,cAAcA,CAACd,OAAmBP,SAAkC;AACzE,UAAIA,MAAMsB,SAAU;AACpBtB,YAAMM,SAASN,KAAKM,MAAMC,OAAOP,IAAI;AACrCW,WAAK,SAASJ,OAAOP,IAAI;AAAA,IAC1B;AAEA,UAAMuB,OAAOA,CAACL,OAAiC;AAAA,MAAEC,GAAG;AAAA,MAAGC,GAAG;AAAA,IAAE,MAAY;AACvEL,YAAMG,OAAOA;AACbH,YAAME,UAAU;AAAA,IACjB;AAEA,UAAMO,QAAQA,MAAY;AACzBT,YAAME,UAAU;AAAA,IACjB;AAEAQ,cAAU,MAAM;AACfC,uBAAiBC,UAAU,SAASH,KAAK;AAAA,IAC1C,CAAC;AAEDI,cAAU,MAAAC,YAAAC,YAAA;AAAA,MAAA,QAAA;AAAA,IAAA,GAAA;AAAA,MAAA1B,SAAAA,MAAA,CAAA2B,eAAAF,YAAA,OAAA;AAAA,QAAA,SAGA,CAAC,mBAAmB,mBAAmBhB,YAAYmB,KAAK,IAAI,+BAA+B;AAAA,QAAC,SAC5F;AAAA,UAAEC,KAAK,GAAGlB,MAAMG,KAAKE,IAAI,CAAC;AAAA,UAAMc,MAAM,GAAGnB,MAAMG,KAAKC,IAAI,EAAE;AAAA;QAAM,OAElEgB,KAAKC,OAAM;AAAA,MAAE,GAAA,CAAAP,YAAA,MAAA;AAAA,QAAA,SAAA;AAAA,MAAA,GAAA,CAGhB9B,MAAMC,KACLqC,OAAQC,OAAM,CAACA,EAAEC,IAAI,EACrBC,IAAKC,UAAIZ,YAAA,MAAA;AAAA,QAAA,SAED,CAAC,0BAA0BY,MAAMnB,aAAa,OAAO,gBAAgB,EAAE;AAAA,QAAC,YAAA;AAAA,QAAA,WAErEf,WAAsB;AAC/Bc,sBAAYd,OAAOkC,IAAI;AAAA,QACxB;AAAA,MAAC,GAAA,CAEAA,MAAMC,OAAIb,YAAAc,QAAA;AAAA,QAAA,QAAiBF,MAAMC;AAAAA,MAAI,GAAA,IAAA,IAAO,MAAIb,YAAA,QAAA,MAAA,CAC1CY,KAAKG,KAAK,CAAA,CAAA,CAAA,CAElB,CAAC,CAAA,CAAA,CAAA,GAAA,CAAA,CAAAC,OAjBG9B,MAAME,OAAO,CAAA,CAAA,CAAA;AAAA,IAAA,CAAA,CAqBtB;AAED,WAAO6B,UAAUlC,QAAQ;AAAA;AAAA,MAExBK,SAAS8B,SAAS,MAAMhC,MAAME,OAAO;AAAA;AAAA,MAErCM;AAAAA;AAAAA,MAEAC;AAAAA,IACD,CAAC;AAAA,EACF;AACD,CAAC;"}