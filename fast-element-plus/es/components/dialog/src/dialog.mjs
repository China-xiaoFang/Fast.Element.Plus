import{defineComponent as e,reactive as l,ref as o,nextTick as a,watch as i,createVNode as n,mergeProps as t,Fragment as d,withDirectives as s,resolveDirective as r,computed as f}from"vue";import{dialogProps as u,dialogEmits as c,useGlobalSize as g,ElMessage as _,ElMessageBox as h,ElDialog as p,ElButton as m,ElScrollbar as v,ElIcon as B}from"element-plus";import{Eleme as C,Refresh as b,Close as y}from"@element-plus/icons-vue";import{FullScreenExit as w,FullScreen as k}from"@fast-element-plus/icons-vue";import{definePropType as F,execFunction as x,consoleError as T,useProps as V,useEmits as D,useRender as S,useExpose as R,makeSlots as O}from"@fast-china/utils";import{isBoolean as H}from"lodash-unified";const P={...u,alignCenter:{type:Boolean,default:!0},appendToBody:{type:Boolean,default:!0},draggable:{type:Boolean,default:!0},destroyOnClose:{type:Boolean,default:!0},overflow:{type:Boolean,default:!0},top:{type:String,default:"5vh"},width:{type:[String,Number],default:"90%"},showRefresh:{type:Boolean,default:!0},showFullscreen:{type:Boolean,default:!0},showCloseButton:{type:Boolean,default:!0},showConfirmButton:{type:Boolean,default:!0},disabledConfirmButton:Boolean,closeButtonText:{type:String,default:"取消"},confirmButtonText:{type:String,default:"确认"},hideFooter:Boolean,fullHeight:Boolean,showBeforeClose:Boolean,afterOpen:{type:F(Function)}},q={...c,"update:modelValue":e=>H(e),confirmClick:()=>!0},I=/* @__PURE__ */e({name:"FaDialog",props:P,emits:q,slots:O(),setup(e,{attrs:F,slots:O,emit:H,expose:P}){const q=g(),I=l({loading:!1,visible:!1,fullscreen:!1,refreshing:!1}),L=o();let N;const U=l=>{I.visible=!0,N=l,a(()=>{I.loading=!0,x(e.afterOpen??l).then(()=>{H("open")}).catch(e=>{T("FaDialog",e),I.visible=!1}).finally(()=>{I.loading=!1})})},$=e=>{I.loading=!0,x(e).then(()=>{H("close"),I.visible=!1}).catch(e=>{T("FaDialog",e)}).finally(()=>{I.loading=!1})},j=()=>{I.loading||(I.refreshing=!0,I.loading=!0,setTimeout(()=>{I.refreshing=!1,U(N),_.success("刷新成功")},500))},z=l=>{if(I.loading)return;if(document.querySelector(".el-image-viewer__wrapper"))return;const o=()=>{x(e.beforeClose).then(()=>{H("close"),l()}).catch(e=>{T("FaDialog",e)})};e.showBeforeClose?h.confirm("确定关闭？",{type:"warning"}).then(()=>{o()}):o()},A=()=>{I.loading||(I.fullscreen=!I.fullscreen)},E=()=>{I.loading||H("confirmClick")},G=()=>{I.loading||$()};i(()=>I.visible,e=>{H("update:modelValue",e)});const J=V(e,u,["modelValue","fullscreen","showClose","beforeClose"]),K=D(c,H,["update:modelValue"]);return S(()=>n(p,t(J.value,K.value,{ref:L,class:["fa-dialog",`fa-dialog-${q.value}`,{"fa-dialog__full-height":e.fullHeight,"fa-dialog__fullscreen":I.fullscreen}],modelValue:I.visible,"onUpdate:modelValue":e=>I.visible=e,fullscreen:I.fullscreen,showClose:!1,beforeClose:z}),{header:()=>n(d,null,[n("div",{class:"fa-dialog__header-title"},[e.title,O.header&&O.header({loading:I.loading,close:G})]),e.showRefresh&&n("div",{title:"刷新",class:["fa-dialog__header-icon",I.loading?"fa__click__disabled fa__click__disabled__cursor ":"fa__hover__twinkle"],onClick:j},[n(B,null,{default:()=>[n(b,null,null)]})]),e.showFullscreen&&n("div",{title:I.fullscreen?"关闭全屏显示":"全屏显示",class:["fa-dialog__header-icon",I.loading?"fa__click__disabled fa__click__disabled__cursor ":"fa__hover__twinkle"],onClick:A},[n(B,null,{default:()=>[I.fullscreen?n(w,null,null):n(k,null,null)]})]),e.showClose&&n("div",{title:"关闭",class:["fa-dialog__header-icon",I.loading?"fa__click__disabled fa__click__disabled__cursor ":"fa__hover__twinkle"],onClick:G},[n(B,null,{default:()=>[n(y,null,null)]})])]),default:()=>s(n(v,{"element-loading-text":"加载中..."},{default:()=>[!I.refreshing&&O.default&&O.default(I)]}),[[r("loading"),I.loading]]),...!e.hideFooter&&{footer:()=>n(d,null,[O.footer&&O.footer({loading:I.loading,close:G}),e.showCloseButton&&n(m,{disabled:I.loading,onClick:G},{default:()=>[e.closeButtonText]}),e.showConfirmButton&&n(m,{loading:I.loading,loadingIcon:C,disabled:e.disabledConfirmButton,type:"primary",onClick:E},{default:()=>[I.loading?"加载中...":e.confirmButtonText]})])}})),R(P,{dialogContentRef:f(()=>L.value?.dialogContentRef),resetPosition:f(()=>L.value?.resetPosition),loading:f(()=>I.loading),visible:f(()=>I.visible),open:U,close:$,refresh:j,doLoading:e=>{I.loading=!0,x(e).then().catch(e=>{T("FaDialog",e)}).finally(()=>{I.loading=!1})}})}});export{I as default,q as faDialogEmits,P as faDialogProps};
//# sourceMappingURL=dialog.mjs.map
