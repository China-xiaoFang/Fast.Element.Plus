{"version":3,"file":"selectPage.mjs","sources":["../../../../../packages/components/selectPage/src/selectPage.tsx"],"sourcesContent":["import { Fragment, computed, defineComponent, onMounted, reactive, ref, watch } from \"vue\";\nimport { ElButton, ElInput, ElOption, ElPagination, ElSelect, useGlobalSize } from \"element-plus\";\nimport { Search } from \"@element-plus/icons-vue\";\nimport { FaSelectOption, SelectProps } from \"@fast-element-plus/components/select\";\nimport { type SelectComponentProps } from \"@fast-element-plus/components/select/src/select\";\nimport { addUnit, consoleError, definePropType, makeSlots, useExpose, useProps, useRender, withDefineType } from \"@fast-china/utils\";\nimport { useVModel } from \"@vueuse/core\";\nimport { isArray, isBoolean, isEqual, isFunction, isNil, isNull, isNumber, isObject, isString } from \"lodash-unified\";\nimport type { ElSelectorOutput } from \"@fast-element-plus/components/select\";\nimport type { PagedInput, PagedResult } from \"@fast-element-plus/components/table\";\nimport type { VNode } from \"vue\";\n\nexport const faSelectPageProps = {\n\t...SelectProps,\n\t/** @description displayed text while loading data from server, default is 'Loading' */\n\tloadingText: {\n\t\ttype: String,\n\t\tdefault: \"加载中...\",\n\t},\n\t/** @description displayed text when no data matches the filtering query, you can also use slot `empty`, default is 'No matching data' */\n\tnoMatchText: {\n\t\ttype: String,\n\t\tdefault: \"暂无匹配的数据\",\n\t},\n\t/** @description displayed text when there is no options, you can also use slot `empty`, default is 'No data' */\n\tnoDataText: {\n\t\ttype: String,\n\t\tdefault: \"暂无数据\",\n\t},\n\t/** @description whether to collapse tags to a text when multiple selecting */\n\tcollapseTags: {\n\t\ttype: Boolean,\n\t\tdefault: true,\n\t},\n\t/** @description whether show all selected tags when mouse hover text of collapse-tags. To use this, `collapse-tags` must be true */\n\tcollapseTagsTooltip: {\n\t\ttype: Boolean,\n\t\tdefault: true,\n\t},\n\t/** @description v-model绑定值 */\n\tmodelValue: {\n\t\ttype: definePropType<string | number | boolean | object | (string | number | boolean | object)[]>([String, Number, Boolean, Object, Array]),\n\t\tdefault: undefined,\n\t},\n\t/** @description v-model:label绑定值 */\n\tlabel: definePropType<string | string[]>([String, Array]),\n\t/** @description 宽度 */\n\twidth: {\n\t\ttype: [String, Number],\n\t\tdefault: \"100%\",\n\t},\n\t/** @description 更多细节，只有使用slot的时候有用 */\n\tmoreDetail: Boolean,\n\t/** @description 配置选项 */\n\tprops: {\n\t\ttype: definePropType<SelectComponentProps>(Object),\n\t\tdefault: (): Partial<SelectComponentProps> => ({\n\t\t\tlabel: \"label\",\n\t\t\thide: \"hide\",\n\t\t\tdisabled: \"disabled\",\n\t\t\tchildren: \"children\",\n\t\t}),\n\t},\n\t/** @description 请求api */\n\trequestApi: {\n\t\ttype: definePropType<(params?: PagedInput) => Promise<PagedResult<ElSelectorOutput>>>(Function),\n\t},\n\t/** 初始化参数 */\n\tinitParam: definePropType<string | number | any>([String, Number, Object]),\n};\n\nexport const faSelectPageEmits = {\n\t/** @description v-model 回调 */\n\t\"update:modelValue\": (value: string | number | boolean | object | (string | number | boolean | object)[]): boolean =>\n\t\tisString(value) || isNumber(value) || isBoolean(value) || isObject(value) || isArray(value) || isNull(value),\n\t/** @description v-model:label 回调 */\n\t\"update:label\": (value: string | string[]): boolean => isString(value) || isArray(value) || isNull(value),\n\t/** @description 数据改变 */\n\tdataChangeCallBack: (data: ElSelectorOutput[] | any[]): boolean => isArray(data),\n\t/** @description 改变 */\n\tchange: (\n\t\tdata: ElSelectorOutput | ElSelectorOutput[] | any | any[],\n\t\tvalue?: string | number | boolean | object | (string | number | boolean | object)[]\n\t): boolean =>\n\t\t(isObject(data) || isArray(data) || isNull(data)) &&\n\t\t(isString(value) || isNumber(value) || isBoolean(value) || isObject(value) || isArray(value) || isNull(value)),\n\t/** @description 下拉框出现/隐藏时触发 */\n\tvisibleChange: (visible: boolean): boolean => isBoolean(visible),\n\t/** @description 多选模式下移除tag时触发 */\n\tremoveTag: (tagValue: any): boolean => isString(tagValue) || isNumber(tagValue) || isBoolean(tagValue) || isObject(tagValue) || isArray(tagValue),\n\t/** @description 可清空的单选模式下用户点击清空按钮时触发 */\n\tclear: (): boolean => true,\n\t/** @description 当 input 失去焦点时触发 */\n\tblur: (event: FocusEvent): boolean => event instanceof FocusEvent,\n\t/** @description 当 input 获得焦点时触发 */\n\tfocus: (event: FocusEvent): boolean => event instanceof FocusEvent,\n};\n\ntype FaSelectPageSlots = {\n\t/** @description FaSelectOption 默认内容插槽 */\n\tdefault: ElSelectorOutput;\n\t/** @description 下拉列表顶部的内容 */\n\theader: never;\n\t/** @description 下拉列表底部的内容 */\n\tfooter: never;\n\t/** @description Select 组件头部内容 */\n\tprefix: never;\n\t/** @description 无选项时的列表 */\n\tempty: never;\n\t/** @description select 组件自定义标签内容 */\n\ttag: never;\n\t/** @description select 组件自定义 loading内容 */\n\tloading: never;\n\t/** @description select 组件自定义标签内容 */\n\tlabel: { label: string; value: string | number | boolean | object };\n};\n\nexport default defineComponent({\n\tname: \"FaSelectPage\",\n\tprops: faSelectPageProps,\n\temits: faSelectPageEmits,\n\tslots: makeSlots<FaSelectPageSlots>(),\n\tsetup(props, { attrs, slots, emit, expose }) {\n\t\tconst selectedLabel = useVModel(props, \"label\", emit, { passive: true });\n\t\tconst _globalSize = useGlobalSize();\n\n\t\tconst state = reactive({\n\t\t\tvalue: withDefineType<string | number | boolean | object | (string | number | boolean | object)[]>(),\n\t\t\tloading: false,\n\t\t\tselectorData: withDefineType<ElSelectorOutput[]>([]),\n\t\t\t/** 选中的数据 */\n\t\t\tselectedList: withDefineType<ElSelectorOutput[]>([]),\n\t\t\t/** 首次出现 */\n\t\t\tdebut: true,\n\t\t\t/** 回显 */\n\t\t\techo: true,\n\t\t\t/** 下次刷新 */\n\t\t\tnextRefresh: false,\n\t\t\tpageIndex: 1,\n\t\t\tpageSize: 15,\n\t\t\ttotalRows: 0,\n\t\t\tsearchValue: undefined,\n\t\t\tdefaultSelectorData: withDefineType<ElSelectorOutput>(),\n\t\t});\n\n\t\tconst selectRef = ref<InstanceType<typeof ElSelect>>();\n\n\t\tconst handleData = (data: ElSelectorOutput[]): ElSelectorOutput[] => {\n\t\t\treturn data\n\t\t\t\t?.map((m) => ({\n\t\t\t\t\t...m,\n\t\t\t\t\tvalue: m[props.valueKey],\n\t\t\t\t\tlabel: isFunction(props.props.label) ? props.props.label(m) : m[props.props.label ?? \"label\"],\n\t\t\t\t\thide: isFunction(props.props.hide) ? props.props.hide(m) : m[props.props.hide ?? \"hide\"],\n\t\t\t\t\tdisabled: isFunction(props.props.disabled) ? props.props.disabled(m) : m[props.props.disabled ?? \"disabled\"],\n\t\t\t\t\tchildren: isFunction(props.props.children)\n\t\t\t\t\t\t? handleData(props.props.children(m))\n\t\t\t\t\t\t: handleData(m[props.props.children ?? \"children\"]),\n\t\t\t\t}))\n\t\t\t\t.filter((f) => !f.hide);\n\t\t};\n\n\t\tconst loadData = async (pageIndex?: number): Promise<void> => {\n\t\t\tstate.loading = true;\n\t\t\tstate.pageIndex = pageIndex ?? state.pageIndex;\n\t\t\tconst params: PagedInput = {\n\t\t\t\t...(props.initParam ?? {}),\n\t\t\t\tpageIndex: state.pageIndex,\n\t\t\t\tpageSize: state.pageSize,\n\t\t\t\tsearchValue: state.searchValue,\n\t\t\t};\n\t\t\ttry {\n\t\t\t\tconst resData = await props.requestApi(params);\n\t\t\t\t// 这里不允许回显了\n\t\t\t\tstate.echo = false;\n\t\t\t\tstate.totalRows = resData.totalRows;\n\t\t\t\tstate.selectorData = handleData(resData.rows);\n\t\t\t\temit(\"dataChangeCallBack\", state.selectorData);\n\t\t\t} catch (error) {\n\t\t\t\tconsoleError(\"FaSelectPage\", error);\n\t\t\t\tstate.pageIndex = 1;\n\t\t\t\tstate.totalRows = 0;\n\t\t\t\tstate.selectorData = [];\n\t\t\t} finally {\n\t\t\t\tstate.loading = false;\n\t\t\t}\n\t\t};\n\n\t\tconst handleChange = (value?: string | number | boolean | object | (string | number | boolean | object)[]): void => {\n\t\t\t// 判断是否为多选\n\t\t\tif (props.multiple) {\n\t\t\t\t// value 必然是数组\n\t\t\t\tconst valueArr = value as (string | number | boolean | object)[];\n\t\t\t\tif (valueArr?.length === 0) {\n\t\t\t\t\tstate.value = null;\n\t\t\t\t\tselectedLabel.value = null;\n\t\t\t\t\tstate.selectedList = [];\n\t\t\t\t\temit(\"update:modelValue\", null);\n\t\t\t\t\temit(\"change\", null, null);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst dataList = state.selectorData.filter((f) => valueArr.includes(f.value));\n\t\t\t\tstate.value = value;\n\t\t\t\tselectedLabel.value = dataList.map((m) => m.label);\n\t\t\t\tstate.selectedList = [...state.selectedList.filter((f) => !dataList.some((s) => s.value === f.value)), ...dataList]\n\t\t\t\t\t// 过滤不存在的\n\t\t\t\t\t.filter((f) => valueArr.includes(f.value));\n\t\t\t\temit(\"update:modelValue\", value);\n\t\t\t\temit(\"change\", dataList, value);\n\t\t\t} else {\n\t\t\t\t// value 必然不是数组\n\t\t\t\tif (isNil(value)) {\n\t\t\t\t\tstate.value = null;\n\t\t\t\t\tselectedLabel.value = null;\n\t\t\t\t\tstate.selectedList = [];\n\t\t\t\t\temit(\"update:modelValue\", null);\n\t\t\t\t\temit(\"change\", null, null);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst data = state.selectorData.find((f) => f.value === value);\n\t\t\t\tstate.value = value;\n\t\t\t\tselectedLabel.value = data.label;\n\t\t\t\tif (!state.selectedList.some((s) => s.value === value)) {\n\t\t\t\t\tstate.selectedList = [data];\n\t\t\t\t}\n\t\t\t\temit(\"update:modelValue\", value);\n\t\t\t\temit(\"change\", data, value);\n\t\t\t}\n\t\t};\n\n\t\tconst handleClear = (): void => {\n\t\t\tstate.value = null;\n\t\t\tselectedLabel.value = null;\n\t\t\tstate.selectedList = [];\n\t\t\temit(\"clear\");\n\t\t};\n\n\t\tconst handleVisibleChange = async (visible: boolean): Promise<void> => {\n\t\t\tif (visible) {\n\t\t\t\tif (state.debut) {\n\t\t\t\t\t// 首次出现\n\t\t\t\t\tstate.debut = false;\n\t\t\t\t\tawait loadData();\n\t\t\t\t} else {\n\t\t\t\t\t// 判断再次出现是否需要刷新数据\n\t\t\t\t\tif (state.nextRefresh) {\n\t\t\t\t\t\tstate.nextRefresh = false;\n\t\t\t\t\t\tawait loadData();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\temit(\"visibleChange\", visible);\n\t\t};\n\n\t\twatch(\n\t\t\t() => props.modelValue,\n\t\t\t(newValue) => {\n\t\t\t\tif (state.echo && !isNil(newValue)) {\n\t\t\t\t\tconst hasLabel = !isNil(props.label);\n\t\t\t\t\t// 判断是否为多选\n\t\t\t\t\tif (props.multiple) {\n\t\t\t\t\t\tif (!isArray(newValue)) {\n\t\t\t\t\t\t\tconsoleError(\"FaSelectPage\", \"当启用 multiple 时，传入的 modelValue 必须是Array。\");\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (hasLabel && !isArray(props.label)) {\n\t\t\t\t\t\t\tconsoleError(\"FaSelectPage\", \"当启用 multiple 时，传入的 modelValue:label 必须是Array。\");\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tstate.selectedList = newValue\n\t\t\t\t\t\t\t// 最大选项截取\n\t\t\t\t\t\t\t.slice(0, props.multipleLimit > 0 ? props.multipleLimit : newValue.length)\n\t\t\t\t\t\t\t.map((item, index) => ({\n\t\t\t\t\t\t\t\tvalue: item,\n\t\t\t\t\t\t\t\tlabel: hasLabel ? props.label[index] : undefined,\n\t\t\t\t\t\t\t}));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (isArray(newValue)) {\n\t\t\t\t\t\t\tconsoleError(\"FaSelectPage\", \"当禁用 multiple 时，传入的 modelValue 不能是Array。\");\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (hasLabel && isArray(props.label)) {\n\t\t\t\t\t\t\tconsoleError(\"FaSelectPage\", \"当禁用 multiple 时，传入的 modelValue:label 不能是Array。\");\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tstate.defaultSelectorData = {\n\t\t\t\t\t\t\tvalue: newValue,\n\t\t\t\t\t\t\tlabel: props.label,\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tstate.value = newValue;\n\t\t\t},\n\t\t\t{\n\t\t\t\timmediate: true,\n\t\t\t}\n\t\t);\n\n\t\tonMounted(() => {\n\t\t\twatch(\n\t\t\t\t() => props.initParam,\n\t\t\t\t(newValue, oldValue) => {\n\t\t\t\t\tif (!isEqual(newValue, oldValue)) {\n\t\t\t\t\t\tstate.nextRefresh = true;\n\t\t\t\t\t\tif (!isNil(state.value)) {\n\t\t\t\t\t\t\thandleChange();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\n\t\tconst elSelectProps = useProps(props, SelectProps, [\"modelValue\", \"popperClass\", \"loading\"]);\n\n\t\tuseRender(() => (\n\t\t\t<ElSelect\n\t\t\t\t{...elSelectProps.value}\n\t\t\t\tref={selectRef}\n\t\t\t\tclass=\"fa-select-page\"\n\t\t\t\tpopperClass={`fa-select-page-dropdown fa-select-page-dropdown-${_globalSize.value} ${props.popperClass}`}\n\t\t\t\tstyle={{ width: addUnit(props.width) }}\n\t\t\t\tvModel={state.value}\n\t\t\t\tloading={state.loading}\n\t\t\t\tonChange={handleChange}\n\t\t\t\tonClear={handleClear}\n\t\t\t\tonVisibleChange={handleVisibleChange}\n\t\t\t\tonRemoveTag={(tagValue: any) => emit(\"removeTag\", tagValue)}\n\t\t\t\tonBlur={(event: FocusEvent) => emit(\"blur\", event)}\n\t\t\t\tonFocus={(event: FocusEvent) => emit(\"focus\", event)}\n\t\t\t>\n\t\t\t\t{{\n\t\t\t\t\tdefault: (): VNode[] =>\n\t\t\t\t\t\tstate.selectorData.map((item) => (\n\t\t\t\t\t\t\t<FaSelectOption vSlots={{ default: slots.default }} data={item} moreDetail={props.moreDetail} />\n\t\t\t\t\t\t)),\n\t\t\t\t\theader: (): VNode[] => (\n\t\t\t\t\t\t<Fragment>\n\t\t\t\t\t\t\t{state.defaultSelectorData && (\n\t\t\t\t\t\t\t\t<ElOption\n\t\t\t\t\t\t\t\t\tclass=\"fa-select-page-dropdown__default-selector\"\n\t\t\t\t\t\t\t\t\tvalue={state.defaultSelectorData.value}\n\t\t\t\t\t\t\t\t\tlabel={state.defaultSelectorData.label}\n\t\t\t\t\t\t\t\t\tdisabled={true}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<span>{state.defaultSelectorData.label}</span>\n\t\t\t\t\t\t\t\t\t<span>Default</span>\n\t\t\t\t\t\t\t\t</ElOption>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t<ElInput\n\t\t\t\t\t\t\t\t\tclass=\"fa-select-page-dropdown__search-input\"\n\t\t\t\t\t\t\t\t\tclearable\n\t\t\t\t\t\t\t\t\tplaceholder=\"请输入关键字搜索\"\n\t\t\t\t\t\t\t\t\tvModel_trim={state.searchValue}\n\t\t\t\t\t\t\t\t\tonKeyup={(event: KeyboardEvent) => {\n\t\t\t\t\t\t\t\t\t\tif (event.key === \"Enter\") {\n\t\t\t\t\t\t\t\t\t\t\tloadData(1);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\tappend: () => <ElButton loading={state.loading} icon={Search} onClick={() => loadData(1)}></ElButton>,\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t</ElInput>\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t{slots.header && slots.header()}\n\t\t\t\t\t\t</Fragment>\n\t\t\t\t\t),\n\t\t\t\t\tfooter: () => (\n\t\t\t\t\t\t<Fragment>\n\t\t\t\t\t\t\t<ElPagination\n\t\t\t\t\t\t\t\tclass=\"fa-select-page-dropdown__pagination\"\n\t\t\t\t\t\t\t\tsize=\"small\"\n\t\t\t\t\t\t\t\tcurrentPage={state.pageIndex}\n\t\t\t\t\t\t\t\tpageSize={state.pageSize}\n\t\t\t\t\t\t\t\ttotal={state.totalRows}\n\t\t\t\t\t\t\t\tlayout=\"prev, pager, next, total\"\n\t\t\t\t\t\t\t\tpagerCount={5}\n\t\t\t\t\t\t\t\tonCurrentChange={loadData}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t{slots.footer && slots.footer()}\n\t\t\t\t\t\t</Fragment>\n\t\t\t\t\t),\n\t\t\t\t\t...(slots.prefix && { prefix: (): VNode[] => slots.prefix() }),\n\t\t\t\t\t...(slots.empty && { empty: (): VNode[] => slots.empty() }),\n\t\t\t\t\t...(slots.tag && { tag: (): VNode[] => slots.tag() }),\n\t\t\t\t\t...(slots.loading && { loading: (): VNode[] => slots.loading() }),\n\t\t\t\t\t...(props.multiple\n\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\tlabel: ({ label, value }: { label: string; value: string | number | boolean | object }): VNode[] => {\n\t\t\t\t\t\t\t\t\tconst selectedData = state.selectedList.find((f) => f.value === value);\n\t\t\t\t\t\t\t\t\tif (slots.label) {\n\t\t\t\t\t\t\t\t\t\treturn slots.label({ label: selectedData?.label, value: isNil(selectedData) ? value : selectedData?.value });\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn selectedData && <span class=\"el-select__tags-text\">{selectedData.label}</span>;\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t: slots.label && {\n\t\t\t\t\t\t\t\tlabel: ({ label, value }: { label: string; value: string | number | boolean | object }): VNode[] =>\n\t\t\t\t\t\t\t\t\tslots.label({ label, value }),\n\t\t\t\t\t\t\t}),\n\t\t\t\t}}\n\t\t\t</ElSelect>\n\t\t));\n\n\t\treturn useExpose(expose, {\n\t\t\t/** @description 使选择器的输入框获取焦点 */\n\t\t\tfocus: computed(() => selectRef.value?.focus),\n\t\t\t/** @description 使选择器的输入框失去焦点，并隐藏下拉框 */\n\t\t\tblur: computed(() => selectRef.value?.blur),\n\t\t\t/** @description 获取当前选中的标签 */\n\t\t\tselectedLabel: computed(() => selectRef.value?.selectedLabel),\n\t\t\t/** @description 加载状态 */\n\t\t\tloading: computed(() => state.loading),\n\t\t\t/** @description 选中的数据 */\n\t\t\tselectedList: computed(() => state.selectedList),\n\t\t\t/** @description 刷新 */\n\t\t\trefresh: loadData,\n\t\t\t/** @description 设置选择 */\n\t\t\tsetSelection: (value: string | number | boolean | object | (string | number | boolean | object)[]) => handleChange(value),\n\t\t\t/** @description 清除选择 */\n\t\t\tclearSelection: () => handleChange(null),\n\t\t});\n\t},\n});\n"],"names":["faSelectPageProps","SelectProps","loadingText","type","String","default","noMatchText","noDataText","collapseTags","Boolean","collapseTagsTooltip","modelValue","definePropType","Number","Object","Array","undefined","label","width","moreDetail","props","hide","disabled","children","requestApi","Function","initParam","faSelectPageEmits","value","isString","isNumber","isBoolean","isObject","isArray","isNull","dataChangeCallBack","data","change","visibleChange","visible","removeTag","tagValue","clear","blur","event","FocusEvent","focus","name","emits","slots","makeSlots","setup","attrs","emit","expose","selectedLabel","useVModel","passive","_globalSize","useGlobalSize","state","reactive","withDefineType","loading","selectorData","selectedList","debut","echo","nextRefresh","pageIndex","pageSize","totalRows","searchValue","defaultSelectorData","selectRef","ref","handleData","map","m","valueKey","isFunction","filter","f","loadData","params","resData","rows","error","consoleError","handleChange","multiple","valueArr","length","dataList","includes","some","s","isNil","find","handleClear","handleVisibleChange","watch","newValue","hasLabel","slice","multipleLimit","item","index","immediate","onMounted","oldValue","isEqual","elSelectProps","useProps","useRender","_createVNode","ElSelect","_mergeProps","popperClass","addUnit","$event","FaSelectOption","header","_Fragment","ElOption","_createTextVNode","ElInput","key","append","ElButton","Search","onClick","footer","ElPagination","prefix","empty","tag","selectedData","useExpose","computed","refresh","setSelection","clearSelection"],"mappings":"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"}