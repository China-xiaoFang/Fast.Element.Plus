{"version":3,"file":"form.mjs","sources":["../../../../../packages/components/form/src/form.tsx"],"sourcesContent":["import { computed, defineComponent, provide, reactive, ref } from \"vue\";\nimport { FaLayoutGrid } from \"@fast-element-plus/components/layoutGrid\";\nimport type { FaLayoutGridBreakPoint } from \"@fast-element-plus/components/layoutGrid\";\nimport { definePropType, formUtil, makeSlots, useExpose, useProps, useRender } from \"@fast-element-plus/utils\";\nimport type { FormInstance, FormValidationResult } from \"element-plus\";\nimport { ElForm, formProps } from \"element-plus\";\nimport { isNumber, isObject } from \"lodash-unified\";\n\nexport const faFormProps = {\n\t...formProps,\n\t/** @description Width of label, e.g. `'50px'`. All its direct child form items will inherit this value. `auto` is supported. */\n\tlabelWidth: {\n\t\ttype: [String, Number],\n\t\tdefault: \"auto\",\n\t},\n\t/** @description Suffix of the label. */\n\tlabelSuffix: {\n\t\ttype: String,\n\t\tdefault: \"：\",\n\t},\n\t/** @description When validation fails, scroll to the first error form entry. */\n\tscrollToError: {\n\t\ttype: Boolean,\n\t\tdefault: true,\n\t},\n\t/** @description 详情From，会删除 FormItem 的 padding-bottom */\n\tdetailForm: Boolean,\n\t/** @description Grid布局*/\n\tgrid: {\n\t\ttype: Boolean,\n\t\tdefault: true,\n\t},\n\t/** @description Grid布局列配置 */\n\tcols: {\n\t\ttype: definePropType<string | number | Record<FaLayoutGridBreakPoint, number>>([String, Number, Object]),\n\t\tdefault: (): Record<FaLayoutGridBreakPoint, number> => ({ xs: 1, sm: 2, md: 3, lg: 4, xl: 5 }),\n\t},\n};\n\ntype FaFormSlots = {\n\t/** @description 默认内容插槽 */\n\tdefault: unknown;\n};\n\nexport default defineComponent({\n\tname: \"FaForm\",\n\tprops: faFormProps,\n\tslots: makeSlots<FaFormSlots>(),\n\tsetup(props, { attrs, slots, expose }) {\n\t\tconst state = reactive({\n\t\t\tcols: computed(() => {\n\t\t\t\tif (isObject(props.cols)) {\n\t\t\t\t\treturn props.cols;\n\t\t\t\t} else {\n\t\t\t\t\tconst colsNumber = isNumber(props.cols) ? props.cols : Number(props.cols);\n\t\t\t\t\treturn { xs: 1, sm: colsNumber, md: colsNumber, lg: colsNumber, xl: colsNumber };\n\t\t\t\t}\n\t\t\t}),\n\t\t\tgap: [20, 0],\n\t\t});\n\n\t\tconst formRef = ref<FormInstance>();\n\n\t\t// 注入 cols\n\t\tprovide(\"faFormCols\", state.cols);\n\n\t\tconst elFormProps = useProps(props, formProps);\n\n\t\tuseRender(() => (\n\t\t\t<ElForm {...elFormProps.value} ref={formRef} class={[\"fa-form\", { \"fa-form-detail\": props.detailForm }]}>\n\t\t\t\t{{\n\t\t\t\t\tdefault: () =>\n\t\t\t\t\t\tprops.grid ? (\n\t\t\t\t\t\t\t<FaLayoutGrid collapsed gap={state.gap} cols={state.cols}>\n\t\t\t\t\t\t\t\t{slots.default && slots.default(state)}\n\t\t\t\t\t\t\t</FaLayoutGrid>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\tslots.default && slots.default(state)\n\t\t\t\t\t\t),\n\t\t\t\t}}\n\t\t\t</ElForm>\n\t\t));\n\n\t\treturn useExpose(expose, {\n\t\t\t...computed(() => ({\n\t\t\t\t/** @description Validate the whole form. Receives a callback or returns `Promise`. */\n\t\t\t\tvalidate: (): FormValidationResult => formUtil.validate(formRef),\n\t\t\t\t/** @description Validate specified fields. */\n\t\t\t\tvalidateField: (): FormValidationResult => formUtil.validateScrollToField(formRef),\n\t\t\t\t/** @description Reset specified fields and remove validation result. */\n\t\t\t\tresetFields: formRef.value?.resetFields,\n\t\t\t\t/** @description Clear validation message for specified fields. */\n\t\t\t\tclearValidate: formRef.value?.clearValidate,\n\t\t\t\t/** @description Scroll to the specified fields. */\n\t\t\t\tscrollToField: formRef.value?.scrollToField,\n\t\t\t\t/** @description All fields context. */\n\t\t\t\tfields: formRef.value?.fields,\n\t\t\t})).value,\n\t\t});\n\t},\n});\n"],"names":["faFormProps","formProps","labelWidth","type","String","Number","default","labelSuffix","scrollToError","Boolean","detailForm","grid","cols","definePropType","Object","xs","sm","md","lg","xl","defineComponent","name","props","slots","makeSlots","setup","attrs","expose","state","reactive","computed","isObject","colsNumber","isNumber","gap","formRef","ref","provide","elFormProps","useProps","useRender","_createVNode","ElForm","_mergeProps","value","FaLayoutGrid","useExpose","validate","formUtil","validateField","validateScrollToField","resetFields","clearValidate","scrollToField","fields"],"mappings":";;;;;;;;;;AAQO,MAAMA,cAAc;AAAA,EAC1B,GAAGC;AAAAA;AAAAA,EAEHC,YAAY;AAAA,IACXC,MAAM,CAACC,QAAQC,MAAM;AAAA,IACrBC,SAAS;AAAA,EACT;AAAA;AAAA,EAEDC,aAAa;AAAA,IACZJ,MAAMC;AAAAA,IACNE,SAAS;AAAA,EACT;AAAA;AAAA,EAEDE,eAAe;AAAA,IACdL,MAAMM;AAAAA,IACNH,SAAS;AAAA,EACT;AAAA;AAAA,EAEDI,YAAYD;AAAAA;AAAAA,EAEZE,MAAM;AAAA,IACLR,MAAMM;AAAAA,IACNH,SAAS;AAAA,EACT;AAAA;AAAA,EAEDM,MAAM;AAAA,IACLT,MAAMU,eAAyE,CAACT,QAAQC,QAAQS,MAAM,CAAC;AAAA,IACvGR,SAASA,OAA+C;AAAA,MAAES,IAAI;AAAA,MAAGC,IAAI;AAAA,MAAGC,IAAI;AAAA,MAAGC,IAAI;AAAA,MAAGC,IAAI;AAAA;EAC3F;AACD;AAOA,MAAeC,uCAAgB;AAAA,EAC9BC,MAAM;AAAA,EACNC,OAAOtB;AAAAA,EACPuB,OAAOC,UAAwB;AAAA,EAC/BC,MAAMH,OAAO;AAAA,IAAEI;AAAAA,IAAOH;AAAAA,IAAOI;AAAAA,EAAO,GAAG;AACtC,UAAMC,QAAQC,SAAS;AAAA,MACtBjB,MAAMkB,SAAS,MAAM;AACpB,YAAIC,SAAST,MAAMV,IAAI,GAAG;AACzB,iBAAOU,MAAMV;AAAAA,QACd,OAAO;AACN,gBAAMoB,aAAaC,SAASX,MAAMV,IAAI,IAAIU,MAAMV,OAAOP,OAAOiB,MAAMV,IAAI;AACxE,iBAAO;AAAA,YAAEG,IAAI;AAAA,YAAGC,IAAIgB;AAAAA,YAAYf,IAAIe;AAAAA,YAAYd,IAAIc;AAAAA,YAAYb,IAAIa;AAAAA;QACrE;AAAA,MACD,CAAC;AAAA,MACDE,KAAK,CAAC,IAAI,CAAC;AAAA,IACZ,CAAC;AAED,UAAMC,UAAUC;AAGhBC,YAAQ,cAAcT,MAAMhB,IAAI;AAEhC,UAAM0B,cAAcC,SAASjB,OAAOrB,SAAS;AAE7CuC,cAAU,MAAAC,YAAAC,QAAAC,WACGL,YAAYM,OAAK;AAAA,MAAA,OAAOT;AAAAA,MAAO,SAAS,CAAC,WAAW;AAAA,QAAE,kBAAkBb,MAAMZ;AAAAA,OAAY;AAAA,IAAC,CAAA,GAAA;AAAA,MAErGJ,SAASA,MACRgB,MAAMX,OAAI8B,YAAAI,cAAA;AAAA,QAAA,aAAA;AAAA,QAAA,OACoBjB,MAAMM;AAAAA,QAAG,QAAQN,MAAMhB;AAAAA,MAAI,GAAA;AAAA,QAAAN,SAAAA,MACtDiB,CAAAA,MAAMjB,WAAWiB,MAAMjB,QAAQsB,KAAK,CAAC;AAAA,MAGvCL,CAAAA,IAAAA,MAAMjB,WAAWiB,MAAMjB,QAAQsB,KAAK;AAAA,IACpC,CAAA,CAGJ;AAED,WAAOkB,UAAUnB,QAAQ;AAAA,MACxB,GAAGG,SAAS,MAAO;;AAAA;AAAA;AAAA,UAElBiB,UAAUA,MAA4BC,SAASD,SAASZ,OAAO;AAAA;AAAA,UAE/Dc,eAAeA,MAA4BD,SAASE,sBAAsBf,OAAO;AAAA;AAAA,UAEjFgB,cAAahB,aAAQS,UAART,mBAAegB;AAAAA;AAAAA,UAE5BC,gBAAejB,aAAQS,UAART,mBAAeiB;AAAAA;AAAAA,UAE9BC,gBAAelB,aAAQS,UAART,mBAAekB;AAAAA;AAAAA,UAE9BC,SAAQnB,aAAQS,UAART,mBAAemB;AAAAA,QACvB;AAAA,OAAC,EAAEV;AAAAA,IACL,CAAC;AAAA,EACF;AACD,CAAC;"}