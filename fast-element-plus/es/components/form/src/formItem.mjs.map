{"version":3,"file":"formItem.mjs","sources":["../../../../../packages/components/form/src/formItem.tsx"],"sourcesContent":["import { Fragment, computed, defineComponent, inject, ref } from \"vue\";\nimport { ElFormItem, formItemProps } from \"element-plus\";\nimport { FaFormItemTip } from \"@fast-element-plus/components/formItemTip\";\nimport { FaLayoutGridItem } from \"@fast-element-plus/components/layoutGrid\";\nimport { makeSlots, useExpose, useProps, useRender } from \"@fast-china/utils\";\nimport { isNumber } from \"lodash-unified\";\nimport type { FormItemInstance } from \"element-plus\";\nimport type { Ref, VNode } from \"vue\";\n\nexport const faFormItemProps = {\n\t...formItemProps,\n\t/** @description Label tips 提示 */\n\ttips: String,\n\t/** @description Grid 布局 */\n\tgrid: {\n\t\ttype: Boolean,\n\t\tdefault: true,\n\t},\n\t/** @description 偏移量 */\n\toffset: {\n\t\ttype: [String, Number],\n\t\tdefault: 0,\n\t},\n\t/** @description 栅格跨度 */\n\tspan: {\n\t\ttype: [String, Number],\n\t},\n\t/** @description 独占一行。如果设置 span 则无效 */\n\trow: Boolean,\n};\n\ntype FaFormItemSlots = {\n\t/** @description 默认内容插槽 */\n\tdefault: never;\n\t/** @description 标签位置显示的内容 */\n\tlabel: { label: string };\n\t/** @description 验证错误信息的显示内容 */\n\terror: { error: string };\n};\n\nexport default defineComponent({\n\tname: \"FaFormItem\",\n\tprops: faFormItemProps,\n\tslots: makeSlots<FaFormItemSlots>(),\n\tsetup(props, { attrs, slots, expose }) {\n\t\tconst formItemRef = ref<FormItemInstance>();\n\n\t\tconst cols = inject<Ref<number>>(\"cols\", ref(4));\n\n\t\t// 获取响应式设置\n\t\tconst getResponsive = (): {\n\t\t\tspan?: number;\n\t\t\toffset?: number;\n\t\t} => {\n\t\t\tif (!props.grid) return {};\n\t\t\tif (props.span) {\n\t\t\t\treturn {\n\t\t\t\t\tspan: isNumber(props.span) ? props.span : Number(props.span),\n\t\t\t\t\toffset: isNumber(props.offset) ? props.offset : Number(props.offset),\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tconst result = {\n\t\t\t\t\tspan: 1,\n\t\t\t\t\toffset: isNumber(props.offset) ? props.offset : Number(props.offset),\n\t\t\t\t};\n\t\t\t\tif (props.row) {\n\t\t\t\t\tresult.span = cols.value;\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t}\n\t\t};\n\n\t\tconst elFormItemProps = useProps(props, formItemProps);\n\n\t\tconst ParcelComponent = props.grid ? FaLayoutGridItem : Fragment;\n\n\t\tuseRender(() => (\n\t\t\t<ParcelComponent {...getResponsive()}>\n\t\t\t\t<ElFormItem ref={formItemRef} {...elFormItemProps.value}>\n\t\t\t\t\t{{\n\t\t\t\t\t\tdefault: () => slots.default(),\n\t\t\t\t\t\t...(slots.label && !props.tips && { label: ({ label }: { label: string }): VNode[] => slots.label({ label }) }),\n\t\t\t\t\t\t...(slots.label &&\n\t\t\t\t\t\t\tprops.tips && {\n\t\t\t\t\t\t\t\tlabel: ({ label }: { label: string }): VNode[] => (\n\t\t\t\t\t\t\t\t\t<FaFormItemTip>\n\t\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\t\tlabel: () => slots.label({ label }),\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t</FaFormItemTip>\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t...(!slots.label &&\n\t\t\t\t\t\t\tprops.tips && {\n\t\t\t\t\t\t\t\tlabel: ({ label }: { label: string }): VNode[] => <FaFormItemTip label={label ?? props.label} tips={props.tips} />,\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t...(slots.error && { error: ({ error }: { error: string }): VNode[] => slots.error({ error }) }),\n\t\t\t\t\t}}\n\t\t\t\t</ElFormItem>\n\t\t\t</ParcelComponent>\n\t\t));\n\n\t\treturn useExpose(expose, {\n\t\t\t/** @description 表单项大小 */\n\t\t\tsize: computed(() => formItemRef.value?.size),\n\t\t\t/** @description 校验消息 */\n\t\t\tvalidateMessage: computed(() => formItemRef.value?.validateMessage),\n\t\t\t/** @description 校验状态 */\n\t\t\tvalidateState: computed(() => formItemRef.value?.validateState),\n\t\t\t/** @description 验证表单项 */\n\t\t\tvalidate: computed(() => formItemRef.value?.validate),\n\t\t\t/** @description 移除该表单项的校验结果 */\n\t\t\tclearValidate: computed(() => formItemRef.value?.clearValidate),\n\t\t\t/** @description 对该表单项进行重置，将其值重置为初始值并移除校验结果 */\n\t\t\tresetField: computed(() => formItemRef.value?.resetField),\n\t\t});\n\t},\n});\n"],"names":["faFormItemProps","formItemProps","tips","String","grid","type","Boolean","default","offset","Number","span","row","name","props","slots","makeSlots","setup","attrs","expose","formItemRef","ref","cols","inject","getResponsive","isNumber","result","value","elFormItemProps","useProps","ParcelComponent","FaLayoutGridItem","Fragment","useRender","_createVNode","ElFormItem","_mergeProps","label","FaFormItemTip","error","useExpose","size","computed","validateMessage","validateState","validate","clearValidate","resetField"],"mappings":"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"}