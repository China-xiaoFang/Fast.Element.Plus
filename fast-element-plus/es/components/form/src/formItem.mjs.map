{"version":3,"file":"formItem.mjs","sources":["../../../../../packages/components/form/src/formItem.tsx"],"sourcesContent":["import { Fragment, computed, defineComponent, inject, ref } from \"vue\";\nimport { ElFormItem, formItemProps } from \"element-plus\";\nimport { FaFormItemTip } from \"@fast-element-plus/components/formItemTip\";\nimport { FaLayoutGridItem } from \"@fast-element-plus/components/layoutGrid\";\nimport { makeSlots, useExpose, useProps, useRender } from \"@fast-china/utils\";\nimport { isNumber } from \"lodash-unified\";\nimport type { FormItemInstance } from \"element-plus\";\nimport type { Ref, VNode } from \"vue\";\n\nexport const faFormItemProps = {\n\t...formItemProps,\n\t/** @description Label tips 提示 */\n\ttips: String,\n\t/** @description Grid 布局 */\n\tgrid: {\n\t\ttype: Boolean,\n\t\tdefault: true,\n\t},\n\t/** @description 偏移量 */\n\toffset: {\n\t\ttype: [String, Number],\n\t\tdefault: 0,\n\t},\n\t/** @description 栅格跨度 */\n\tspan: {\n\t\ttype: [String, Number],\n\t},\n\t/** @description 独占一行。如果设置 span 则无效 */\n\trow: Boolean,\n};\n\ntype FaFormItemSlots = {\n\t/** @description 默认内容插槽 */\n\tdefault: never;\n\t/** @description 标签位置显示的内容 */\n\tlabel: { label: string };\n\t/** @description 验证错误信息的显示内容 */\n\terror: { error: string };\n};\n\nexport default defineComponent({\n\tname: \"FaFormItem\",\n\tprops: faFormItemProps,\n\tslots: makeSlots<FaFormItemSlots>(),\n\tsetup(props, { attrs, slots, expose }) {\n\t\tconst formItemRef = ref<FormItemInstance>();\n\n\t\tconst cols = inject<Ref<number>>(\"cols\", ref(4));\n\n\t\t// 获取响应式设置\n\t\tconst getResponsive = (): {\n\t\t\tspan?: number;\n\t\t\toffset?: number;\n\t\t} => {\n\t\t\tif (!props.grid) return {};\n\t\t\tif (props.span) {\n\t\t\t\treturn {\n\t\t\t\t\tspan: isNumber(props.span) ? props.span : Number(props.span),\n\t\t\t\t\toffset: isNumber(props.offset) ? props.offset : Number(props.offset),\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tconst result = {\n\t\t\t\t\tspan: 1,\n\t\t\t\t\toffset: isNumber(props.offset) ? props.offset : Number(props.offset),\n\t\t\t\t};\n\t\t\t\tif (props.row) {\n\t\t\t\t\tresult.span = cols.value;\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t}\n\t\t};\n\n\t\tconst elFormItemProps = useProps(props, formItemProps);\n\n\t\tconst ParcelComponent = props.grid ? FaLayoutGridItem : Fragment;\n\n\t\tuseRender(() => (\n\t\t\t<ParcelComponent {...getResponsive()}>\n\t\t\t\t<ElFormItem ref={formItemRef} {...elFormItemProps.value}>\n\t\t\t\t\t{{\n\t\t\t\t\t\tdefault: () => slots.default(),\n\t\t\t\t\t\t...(slots.label && !props.tips && { label: ({ label }: { label: string }): VNode[] => slots.label({ label }) }),\n\t\t\t\t\t\t...(slots.label &&\n\t\t\t\t\t\t\tprops.tips && {\n\t\t\t\t\t\t\t\tlabel: ({ label }: { label: string }): VNode[] => (\n\t\t\t\t\t\t\t\t\t<FaFormItemTip>\n\t\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\t\tlabel: () => slots.label({ label }),\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t</FaFormItemTip>\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t...(!slots.label &&\n\t\t\t\t\t\t\tprops.tips && {\n\t\t\t\t\t\t\t\tlabel: ({ label }: { label: string }): VNode[] => <FaFormItemTip label={label ?? props.label} tips={props.tips} />,\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t...(slots.error && { error: ({ error }: { error: string }): VNode[] => slots.error({ error }) }),\n\t\t\t\t\t}}\n\t\t\t\t</ElFormItem>\n\t\t\t</ParcelComponent>\n\t\t));\n\n\t\treturn useExpose(expose, {\n\t\t\t/** @description 表单项大小 */\n\t\t\tsize: computed(() => formItemRef.value?.size),\n\t\t\t/** @description 校验消息 */\n\t\t\tvalidateMessage: computed(() => formItemRef.value?.validateMessage),\n\t\t\t/** @description 校验状态 */\n\t\t\tvalidateState: computed(() => formItemRef.value?.validateState),\n\t\t\t/** @description 验证表单项 */\n\t\t\tvalidate: computed(() => formItemRef.value?.validate),\n\t\t\t/** @description 移除该表单项的校验结果 */\n\t\t\tclearValidate: computed(() => formItemRef.value?.clearValidate),\n\t\t\t/** @description 对该表单项进行重置，将其值重置为初始值并移除校验结果 */\n\t\t\tresetField: computed(() => formItemRef.value?.resetField),\n\t\t});\n\t},\n});\n"],"names":["faFormItemProps","formItemProps","tips","String","grid","type","Boolean","default","offset","Number","span","row","FormItem","name","props","slots","makeSlots","setup","attrs","expose","formItemRef","ref","cols","inject","elFormItemProps","useProps","ParcelComponent","FaLayoutGridItem","Fragment","useRender","_createVNode","getResponsive","isNumber","result","value","ElFormItem","_mergeProps","label","FaFormItemTip","error","useExpose","size","computed","validateMessage","validateState","validate","clearValidate","resetField"],"mappings":"mbASO,MAAMA,EAAkB,IAC3BC,EAEHC,KAAMC,OAENC,KAAM,CACLC,KAAMC,QACNC,SAAS,GAGVC,OAAQ,CACPH,KAAM,CAACF,OAAQM,QACfF,QAAS,GAGVG,KAAM,CACLL,KAAM,CAACF,OAAQM,SAGhBE,IAAKL,SAYNM,mBAA+B,CAC9BC,KAAM,aACNC,MAAOd,EACPe,MAAOC,IACPC,KAAAA,CAAMH,GAAOI,MAAEA,EAAAA,MAAOH,EAAAA,OAAOI,IAC5B,MAAMC,EAAcC,IAEdC,EAAOC,EAAoB,OAAQF,EAAI,IAyBvCG,EAAkBC,EAASX,EAAOb,GAElCyB,EAAkBZ,EAAMV,KAAOuB,EAAmBC,EA4BxD,OA1BAC,EAAU,IAAAC,EAAAJ,EA1BYK,MAIrB,IAAKjB,EAAMV,KAAM,MAAO,CAAA,EACxB,GAAIU,EAAMJ,KACT,MAAO,CACNA,KAAMsB,EAASlB,EAAMJ,MAAQI,EAAMJ,KAAOD,OAAOK,EAAMJ,MACvDF,OAAQwB,EAASlB,EAAMN,QAAUM,EAAMN,OAASC,OAAOK,EAAMN,SAExD,CACN,MAAMyB,EAAS,CACdvB,KAAM,EACNF,OAAQwB,EAASlB,EAAMN,QAAUM,EAAMN,OAASC,OAAOK,EAAMN,SAK9D,OAHIM,EAAMH,MACTsB,EAAOvB,KAAOY,EAAKY,OAEbD,CACR,GAQqBF,GAAe,CAAAxB,QAAAA,IAAA,CAAAuB,EAAAK,EAAAC,EAAA,CAAAf,IAClBD,GAAiBI,EAAgBU,OAAK,CAErD3B,QAASA,IAAMQ,EAAMR,aACjBQ,EAAMsB,QAAUvB,EAAMZ,MAAQ,CAAEmC,MAAOA,EAAGA,WAAwCtB,EAAMsB,MAAM,CAAEA,cAChGtB,EAAMsB,OACTvB,EAAMZ,MAAQ,CACbmC,MAAOA,EAAGA,WAA0BP,EAAAQ,EAAA,KAAA,CAGjCD,MAAOA,IAAMtB,EAAMsB,MAAM,CAAEA,iBAK3BtB,EAAMsB,OACVvB,EAAMZ,MAAQ,CACbmC,MAAOA,EAAGA,WAA0BP,EAAAQ,EAAA,CAAAD,MAAoCA,GAASvB,EAAMuB,MAAKnC,KAAQY,EAAMZ,MAAI,UAE5Ga,EAAMwB,OAAS,CAAEA,MAAOA,EAAGA,WAAwCxB,EAAMwB,MAAM,CAAEA,iBAMlFC,EAAUrB,EAAQ,CAExBsB,KAAMC,EAAS,IAAMtB,EAAYc,OAAOO,MAExCE,gBAAiBD,EAAS,IAAMtB,EAAYc,OAAOS,iBAEnDC,cAAeF,EAAS,IAAMtB,EAAYc,OAAOU,eAEjDC,SAAUH,EAAS,IAAMtB,EAAYc,OAAOW,UAE5CC,cAAeJ,EAAS,IAAMtB,EAAYc,OAAOY,eAEjDC,WAAYL,EAAS,IAAMtB,EAAYc,OAAOa,aAEhD"}