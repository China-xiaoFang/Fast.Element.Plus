import{isVNode as e,defineComponent as l,reactive as a,computed as t,ref as r,inject as o,createVNode as u,Fragment as n,createTextVNode as i,mergeProps as p}from"vue";import{formContextKey as s,formItemContextKey as d,ElMessage as c,inputProps as m,ElPopover as v,ElButton as _,ElInput as f}from"element-plus";import{Back as b}from"@element-plus/icons-vue";import"../../../constants/index.mjs";import{useProps as h,useRender as g}from"@fast-china/utils";import{useVModel as y}from"@vueuse/core";import{isString as C,isNull as k}from"lodash-unified";import{CarNumberArea as w,CarNumberDigit as j,CarNumberLetter as V}from"./common.mjs";import{RegExps as x}from"../../../constants/regex.mjs";function B(l){return"function"==typeof l||"[object Object]"===Object.prototype.toString.call(l)&&!e(l)}const F=/* @__PURE__ */l({name:"FaCarNumber",props:{...m,modelValue:{type:String,default:void 0},placeholder:{type:String,default:"请选择"}},emits:{"update:modelValue":e=>C(e)||k(e),change:e=>C(e)||k(e)},setup(e,{attrs:l,slots:C,emit:k,expose:F}){const N=y(e,"modelValue",k,{passive:!0}),A=a({switchLetter:t(()=>N.value?.length>=1),disabledButton:t(()=>N.value?.length>=8)}),L=r(),S=o(s,void 0),$=o(d,void 0),O=e=>2===e.length?`${e} ● `:e.length>2?`${e.slice(0,2)} ● ${e.slice(2)}`:e,E=e=>{N.value??="",N.value+=e},U=()=>{0!==N.value?.length&&(N.value=N.value.substring(0,N.value.length-1))},q=()=>{let e=!1;7===N.value.length?e=x.CarNumber.test(N.value):8===N.value.length&&(e=x.NewEnergyCarNumber.test(N.value)),e?(k("change",N.value),$?.prop&&S?.validateField([$.prop])):$?.prop&&S?(k("change",N.value),S.validateField([$.prop])):c.error("车牌号格式不正确"),L.value?.hide()},z=()=>{N.value=null,k("change",null),$?.prop&&S?.validateField([$.prop])},D=h(e,m,["modelValue","readonly","formatter"]);g(()=>u(v,{ref:L,width:"auto",popperClass:"fa-car-number__popover",trigger:"click",showArrow:!1,showAfter:0,hideAfter:0},{reference:()=>u(f,p(D.value,{class:"fa-car-number__input",modelValue:N.value,"onUpdate:modelValue":e=>N.value=e,readonly:!0,formatter:O}),null),default:()=>u(n,null,[u("div",{class:["fa-car-number__popover__area",A.switchLetter?"fa-car-number__popover__hide":""]},[w.map(e=>u(_,{disabled:A.disabledButton,onClick:()=>E(e)},B(e)?e:{default:()=>[e]}))]),u("div",{class:["fa-car-number__popover__digit-letter",A.switchLetter?"":"fa-car-number__popover__hide"]},[j.map(e=>u(_,{disabled:A.disabledButton,onClick:()=>E(e)},B(e)?e:{default:()=>[e]})),V.map(e=>u(_,{disabled:A.disabledButton,onClick:()=>E(e)},B(e)?e:{default:()=>[e]}))]),u("div",{class:"fa-car-number__popover__btn"},[u(_,{class:"fa-car-number__popover__btn__clear",disabled:null===N.value||0===N.value.length,onClick:z},{default:()=>[i("清除")]}),u(_,{class:"fa-car-number__popover__btn__back",type:"danger",icon:b,disabled:null===N.value||0===N.value.length,onClick:U},null),u(_,{class:"fa-car-number__popover__btn__confirm",type:"primary",disabled:null===N.value||N.value.length<7,onClick:q},{default:()=>[i("确认")]})])])}))}});export{F as default};
//# sourceMappingURL=carNumber.mjs.map
