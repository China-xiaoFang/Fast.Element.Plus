{"version":3,"file":"index.mjs","sources":["../../../../packages/directives/click-draggable/index.ts"],"sourcesContent":["/*\n\t需求：实现一个拖拽指令，可在父元素区域任意拖拽元素。\n\n\t思路：\n\t\t1、设置需要拖拽的元素为absolute，其父元素为relative。\n\t\t2、鼠标按下(onmousedown)时记录目标元素当前的 left 和 top 值。\n\t\t3、鼠标移动(onmousemove)时计算每次移动的横向距离和纵向距离的变化值，并改变元素的 left 和 top 值\n\t\t4、鼠标松开(onmouseup)时完成一次拖拽\n\n\t使用：在 Dom 上加上 v-draggable 即可\n\t<div class=\"dialofa-model\" v-draggable></div>\n*/\nimport { withInstallDirective } from \"@fast-china/utils\";\nimport type { Directive } from \"vue\";\n\ninterface ElType extends HTMLElement {\n\tparentNode: any;\n}\n\nconst DraggableDirective: Directive = {\n\tmounted(el: ElType) {\n\t\tel.style.cursor = \"move\";\n\t\tel.style.position = \"absolute\";\n\t\tel.onmousedown = (e): void => {\n\t\t\tconst disX = e.pageX - el.offsetLeft;\n\t\t\tconst disY = e.pageY - el.offsetTop;\n\t\t\tdocument.onmousemove = (e): void => {\n\t\t\t\tlet x = e.pageX - disX;\n\t\t\t\tlet y = e.pageY - disY;\n\t\t\t\tconst maxX = el.parentNode.offsetWidth - el.offsetWidth;\n\t\t\t\tconst maxY = el.parentNode.offsetHeight - el.offsetHeight;\n\t\t\t\tif (x < 0) {\n\t\t\t\t\tx = 0;\n\t\t\t\t} else if (x > maxX) {\n\t\t\t\t\tx = maxX;\n\t\t\t\t}\n\n\t\t\t\tif (y < 0) {\n\t\t\t\t\ty = 0;\n\t\t\t\t} else if (y > maxY) {\n\t\t\t\t\ty = maxY;\n\t\t\t\t}\n\t\t\t\tel.style.left = `${x}px`;\n\t\t\t\tel.style.top = `${y}px`;\n\t\t\t};\n\t\t\tdocument.onmouseup = (): void => {\n\t\t\t\tdocument.onmousemove = document.onmouseup = null;\n\t\t\t};\n\t\t};\n\t},\n};\n\nexport const vDraggable = withInstallDirective(DraggableDirective, \"draggable\");\nexport default vDraggable;\n"],"names":["e"],"mappings":";AAmBA,MAAM,qBAAgC;AAAA,EACrC,QAAQ,IAAY;AACnB,OAAG,MAAM,SAAS;AAClB,OAAG,MAAM,WAAW;AACpB,OAAG,cAAc,CAAC,MAAY;AAC7B,YAAM,OAAO,EAAE,QAAQ,GAAG;AAC1B,YAAM,OAAO,EAAE,QAAQ,GAAG;AAC1B,eAAS,cAAc,CAACA,OAAY;AACnC,YAAI,IAAIA,GAAE,QAAQ;AAClB,YAAI,IAAIA,GAAE,QAAQ;AAClB,cAAM,OAAO,GAAG,WAAW,cAAc,GAAG;AAC5C,cAAM,OAAO,GAAG,WAAW,eAAe,GAAG;AAC7C,YAAI,IAAI,GAAG;AACV,cAAI;AAAA,QACL,WAAW,IAAI,MAAM;AACpB,cAAI;AAAA,QACL;AAEA,YAAI,IAAI,GAAG;AACV,cAAI;AAAA,QACL,WAAW,IAAI,MAAM;AACpB,cAAI;AAAA,QACL;AACA,WAAG,MAAM,OAAO,GAAG,CAAC;AACpB,WAAG,MAAM,MAAM,GAAG,CAAC;AAAA,MACpB;AACA,eAAS,YAAY,MAAY;AAChC,iBAAS,cAAc,SAAS,YAAY;AAAA,MAC7C;AAAA,IACD;AAAA,EACD;AACD;AAEO,MAAM,aAAa,qBAAqB,oBAAoB,WAAW;"}