{"version":3,"file":"index.mjs","sources":["../../../../packages/directives/click-draggable/index.ts"],"sourcesContent":["/*\n\t需求：实现一个拖拽指令，可在父元素区域任意拖拽元素。\n\n\t思路：\n\t\t1、设置需要拖拽的元素为absolute，其父元素为relative。\n\t\t2、鼠标按下(onmousedown)时记录目标元素当前的 left 和 top 值。\n\t\t3、鼠标移动(onmousemove)时计算每次移动的横向距离和纵向距离的变化值，并改变元素的 left 和 top 值\n\t\t4、鼠标松开(onmouseup)时完成一次拖拽\n\n\t使用：在 Dom 上加上 v-draggable 即可\n\t<div class=\"dialog-model\" v-draggable></div>\n*/\nimport { withInstallDirective } from \"@fast-china/utils\";\nimport type { Directive } from \"vue\";\n\ninterface DraggableElement extends HTMLElement {\n\tparentNode: any;\n}\n\nconst DraggableDirective: Directive = {\n\tmounted(el: DraggableElement) {\n\t\tel.style.cursor = \"move\";\n\t\tel.style.position = \"absolute\";\n\t\tel.onmousedown = (e): void => {\n\t\t\tconst disX = e.pageX - el.offsetLeft;\n\t\t\tconst disY = e.pageY - el.offsetTop;\n\t\t\tdocument.onmousemove = (e): void => {\n\t\t\t\tlet x = e.pageX - disX;\n\t\t\t\tlet y = e.pageY - disY;\n\t\t\t\tconst maxX = el.parentNode.offsetWidth - el.offsetWidth;\n\t\t\t\tconst maxY = el.parentNode.offsetHeight - el.offsetHeight;\n\t\t\t\tif (x < 0) {\n\t\t\t\t\tx = 0;\n\t\t\t\t} else if (x > maxX) {\n\t\t\t\t\tx = maxX;\n\t\t\t\t}\n\n\t\t\t\tif (y < 0) {\n\t\t\t\t\ty = 0;\n\t\t\t\t} else if (y > maxY) {\n\t\t\t\t\ty = maxY;\n\t\t\t\t}\n\t\t\t\tel.style.left = `${x}px`;\n\t\t\t\tel.style.top = `${y}px`;\n\t\t\t};\n\t\t\tdocument.onmouseup = (): void => {\n\t\t\t\tdocument.onmousemove = document.onmouseup = null;\n\t\t\t};\n\t\t};\n\t},\n};\n\nexport const vDraggable = withInstallDirective(DraggableDirective, \"draggable\");\nexport default vDraggable;\n"],"names":["vDraggable","withInstallDirective","mounted","el","style","cursor","position","onmousedown","e","disX","pageX","offsetLeft","disY","pageY","offsetTop","document","onmousemove","x","y","maxX","parentNode","offsetWidth","maxY","offsetHeight","left","top","onmouseup"],"mappings":"yDAmBA,MAiCaA,EAAaC,EAjCY,CACrC,OAAAC,CAAQC,GACPA,EAAGC,MAAMC,OAAS,OAClBF,EAAGC,MAAME,SAAW,WACpBH,EAAGI,YAAeC,IACjB,MAAMC,EAAOD,EAAEE,MAAQP,EAAGQ,WACpBC,EAAOJ,EAAEK,MAAQV,EAAGW,UAC1BC,SAASC,YAAeR,IACvB,IAAIS,EAAIT,EAAEE,MAAQD,EACdS,EAAIV,EAAEK,MAAQD,EAClB,MAAMO,EAAOhB,EAAGiB,WAAWC,YAAclB,EAAGkB,YACtCC,EAAOnB,EAAGiB,WAAWG,aAAepB,EAAGoB,aACzCN,EAAI,EACPA,EAAI,EACMA,EAAIE,IACdF,EAAIE,GAGDD,EAAI,EACPA,EAAI,EACMA,EAAII,IACdJ,EAAII,GAELnB,EAAGC,MAAMoB,KAAO,GAAGP,MACnBd,EAAGC,MAAMqB,IAAM,GAAGP,OAEnBH,SAASW,UAAY,KACpBX,SAASC,YAAcD,SAASW,UAAY,MAG/C,GAGkE"}