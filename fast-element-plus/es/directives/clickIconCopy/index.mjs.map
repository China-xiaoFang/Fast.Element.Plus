{"version":3,"file":"index.mjs","sources":["../../../../packages/directives/clickIconCopy/index.ts"],"sourcesContent":["/**\n * v-iconCopy\n * 左侧插入复制图标，复制某个值至剪贴板\n * 接收参数：string类型/Ref<string>类型/Reactive<string>类型\n */\nimport { type Directive, type DirectiveBinding, h, render } from \"vue\";\nimport { CopyDocument } from \"@element-plus/icons-vue\";\nimport { consoleError, stringUtil, withInstallDirective } from \"@fast-element-plus/utils\";\nimport { ElIcon, ElMessage } from \"element-plus\";\n\ninterface ElType extends HTMLElement {\n\tcopyData: string | number;\n\t__iconElement__: Node;\n}\n\nconst IconCopyDirective: Directive = {\n\tmounted(el: ElType, binding: DirectiveBinding) {\n\t\tel.copyData = binding.value;\n\n\t\tif (!el.copyData) return;\n\n\t\tconst handleCopyClick = async (): Promise<void> => {\n\t\t\ttry {\n\t\t\t\tawait stringUtil.copy(String(el.copyData));\n\t\t\t\tElMessage({\n\t\t\t\t\ttype: \"success\",\n\t\t\t\t\tmessage: \"复制成功\",\n\t\t\t\t});\n\t\t\t} catch (error) {\n\t\t\t\tElMessage({\n\t\t\t\t\ttype: \"error\",\n\t\t\t\t\tmessage: \"复制失败\",\n\t\t\t\t});\n\t\t\t\tconsoleError(\"CopyDirective\", \"复制失败\", error);\n\t\t\t}\n\t\t};\n\n\t\t// 创建 ELIcon 组件\n\t\tconst iconEl = h(\n\t\t\tElIcon,\n\t\t\t{\n\t\t\t\tclass: \"fa-icon-CopyDocument\",\n\t\t\t\ttitle: \"复制\",\n\t\t\t\tonClick: handleCopyClick,\n\t\t\t},\n\t\t\t{\n\t\t\t\tdefault: () => h(CopyDocument),\n\t\t\t}\n\t\t);\n\n\t\tconst tempDiv = document.createElement(\"div\");\n\t\trender(iconEl, tempDiv);\n\n\t\tel.__iconElement__ = tempDiv.firstChild;\n\t\tel.parentElement.insertBefore(tempDiv.firstChild, el);\n\t},\n\tupdated(el: ElType, binding: DirectiveBinding) {\n\t\tel.copyData = binding.value;\n\t},\n\tbeforeUnmount(el: ElType) {\n\t\tif (el.__iconElement__) {\n\t\t\tel.parentElement.removeChild(el.__iconElement__);\n\t\t}\n\t},\n};\n\nexport const vIconCopy = withInstallDirective(IconCopyDirective, \"iconCopy\");\nexport default vIconCopy;\n"],"names":[],"mappings":";;;;;;;AAeA,MAAM,oBAA+B;AAAA,EACpC,QAAQ,IAAY,SAA2B;AAC9C,OAAG,WAAW,QAAQ;AAElB,QAAA,CAAC,GAAG,SAAU;AAElB,UAAM,kBAAkB,YAA2B;AAC9C,UAAA;AACH,cAAM,WAAW,KAAK,OAAO,GAAG,QAAQ,CAAC;AAC/B,kBAAA;AAAA,UACT,MAAM;AAAA,UACN,SAAS;AAAA,QAAA,CACT;AAAA,eACO,OAAO;AACL,kBAAA;AAAA,UACT,MAAM;AAAA,UACN,SAAS;AAAA,QAAA,CACT;AACY,qBAAA,iBAAiB,QAAQ,KAAK;AAAA,MAC5C;AAAA,IAAA;AAID,UAAM,SAAS;AAAA,MACd;AAAA,MACA;AAAA,QACC,OAAO;AAAA,QACP,OAAO;AAAA,QACP,SAAS;AAAA,MACV;AAAA,MACA;AAAA,QACC,SAAS,MAAM,EAAE,YAAY;AAAA,MAC9B;AAAA,IAAA;AAGK,UAAA,UAAU,SAAS,cAAc,KAAK;AAC5C,WAAO,QAAQ,OAAO;AAEtB,OAAG,kBAAkB,QAAQ;AAC7B,OAAG,cAAc,aAAa,QAAQ,YAAY,EAAE;AAAA,EACrD;AAAA,EACA,QAAQ,IAAY,SAA2B;AAC9C,OAAG,WAAW,QAAQ;AAAA,EACvB;AAAA,EACA,cAAc,IAAY;AACzB,QAAI,GAAG,iBAAiB;AACpB,SAAA,cAAc,YAAY,GAAG,eAAe;AAAA,IAChD;AAAA,EACD;AACD;AAEa,MAAA,YAAY,qBAAqB,mBAAmB,UAAU;"}