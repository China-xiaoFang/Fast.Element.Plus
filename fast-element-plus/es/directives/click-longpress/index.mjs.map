{"version":3,"file":"index.mjs","sources":["../../../../packages/directives/click-longpress/index.ts"],"sourcesContent":["/**\n * v-longpress\n * 长按指令，长按时触发事件\n */\nimport { withInstallDirective } from \"@fast-china/utils\";\nimport type { Directive, DirectiveBinding } from \"vue\";\n\nconst LongpressDirective: Directive = {\n\tmounted(el: HTMLElement, binding: DirectiveBinding) {\n\t\tif (typeof binding.value !== \"function\") {\n\t\t\tthrow \"callback must be a function\";\n\t\t}\n\n\t\t// 运行函数\n\t\tconst handler = (e: MouseEvent | TouchEvent): void => {\n\t\t\tbinding.value(e);\n\t\t};\n\n\t\t// 定义变量\n\t\tlet pressTimer: any = null;\n\t\t// 创建计时器（ 2秒后执行函数 ）\n\t\tconst start = (e: any): void => {\n\t\t\tif (e.button) {\n\t\t\t\tif (e.type === \"click\" && e.button !== 0) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (pressTimer === null) {\n\t\t\t\tpressTimer = setTimeout(() => {\n\t\t\t\t\thandler(e);\n\t\t\t\t}, 1000);\n\t\t\t}\n\t\t};\n\t\t// 取消计时器\n\t\tconst cancel = (): void => {\n\t\t\tif (pressTimer !== null) {\n\t\t\t\tclearTimeout(pressTimer);\n\t\t\t\tpressTimer = null;\n\t\t\t}\n\t\t};\n\t\t// 添加事件监听器\n\t\tel.addEventListener(\"mousedown\", start);\n\t\tel.addEventListener(\"touchstart\", start);\n\t\t// 取消计时器\n\t\tel.addEventListener(\"click\", cancel);\n\t\tel.addEventListener(\"mouseout\", cancel);\n\t\tel.addEventListener(\"touchend\", cancel);\n\t\tel.addEventListener(\"touchcancel\", cancel);\n\t},\n};\n\nexport const vLongpress = withInstallDirective(LongpressDirective, \"longpress\");\nexport default vLongpress;\n"],"names":[],"mappings":";AAOA,MAAM,qBAAgC;AAAA,EACrC,QAAQ,IAAiB,SAA2B;AACnD,QAAI,OAAO,QAAQ,UAAU,YAAY;AACxC,YAAM;AAAA,IACP;AAGA,UAAM,UAAU,CAAC,MAAqC;AACrD,cAAQ,MAAM,CAAC;AAAA,IAChB;AAGA,QAAI,aAAkB;AAEtB,UAAM,QAAQ,CAAC,MAAiB;AAC/B,UAAI,EAAE,QAAQ;AACb,YAAI,EAAE,SAAS,WAAW,EAAE,WAAW,GAAG;AACzC;AAAA,QACD;AAAA,MACD;AACA,UAAI,eAAe,MAAM;AACxB,qBAAa,WAAW,MAAM;AAC7B,kBAAQ,CAAC;AAAA,QACV,GAAG,GAAI;AAAA,MACR;AAAA,IACD;AAEA,UAAM,SAAS,MAAY;AAC1B,UAAI,eAAe,MAAM;AACxB,qBAAa,UAAU;AACvB,qBAAa;AAAA,MACd;AAAA,IACD;AAEA,OAAG,iBAAiB,aAAa,KAAK;AACtC,OAAG,iBAAiB,cAAc,KAAK;AAEvC,OAAG,iBAAiB,SAAS,MAAM;AACnC,OAAG,iBAAiB,YAAY,MAAM;AACtC,OAAG,iBAAiB,YAAY,MAAM;AACtC,OAAG,iBAAiB,eAAe,MAAM;AAAA,EAC1C;AACD;AAEO,MAAM,aAAa,qBAAqB,oBAAoB,WAAW;"}