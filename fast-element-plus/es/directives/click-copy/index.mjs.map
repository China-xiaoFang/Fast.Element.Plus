{"version":3,"file":"index.mjs","sources":["../../../../packages/directives/click-copy/index.ts"],"sourcesContent":["/**\n * v-copy\n * 复制某个值至剪贴板\n * 接收参数：string类型/Ref<string>类型/Reactive<string>类型\n */\nimport { ElMessage } from \"element-plus\";\nimport { stringUtil, withInstallDirective } from \"@fast-china/utils\";\nimport type { Directive, DirectiveBinding } from \"vue\";\n\ninterface ElType extends HTMLElement {\n\tcopyData: string | number;\n\t__handleClick__: () => void;\n}\n\nconst CopyDirective: Directive = {\n\tmounted(el: ElType, binding: DirectiveBinding) {\n\t\tel.copyData = binding.value;\n\n\t\tel.__handleClick__ = async (): Promise<void> => {\n\t\t\tif (!el.copyData) return;\n\t\t\ttry {\n\t\t\t\tawait stringUtil.copy(String(el.copyData));\n\t\t\t\tElMessage({\n\t\t\t\t\ttype: \"success\",\n\t\t\t\t\tmessage: \"复制成功\",\n\t\t\t\t});\n\t\t\t} catch (error) {\n\t\t\t\tElMessage({\n\t\t\t\t\ttype: \"error\",\n\t\t\t\t\tmessage: \"复制失败\",\n\t\t\t\t});\n\t\t\t\tthrow error;\n\t\t\t}\n\t\t};\n\t\tel.addEventListener(\"click\", el.__handleClick__);\n\t},\n\tupdated(el: ElType, binding: DirectiveBinding) {\n\t\tel.copyData = binding.value;\n\t},\n\tbeforeUnmount(el: ElType) {\n\t\tel.removeEventListener(\"click\", el.__handleClick__);\n\t},\n};\n\nexport const vCopy = withInstallDirective(CopyDirective, \"copy\");\nexport default vCopy;\n"],"names":[],"mappings":";;AAcA,MAAM,gBAA2B;AAAA,EAChC,QAAQ,IAAY,SAA2B;AAC9C,OAAG,WAAW,QAAQ;AAEtB,OAAG,kBAAkB,YAA2B;AAC/C,UAAI,CAAC,GAAG,SAAU;AAClB,UAAI;AACH,cAAM,WAAW,KAAK,OAAO,GAAG,QAAQ,CAAC;AACzC,kBAAU;AAAA,UACT,MAAM;AAAA,UACN,SAAS;AAAA,QAAA,CACT;AAAA,MACF,SAAS,OAAO;AACf,kBAAU;AAAA,UACT,MAAM;AAAA,UACN,SAAS;AAAA,QAAA,CACT;AACD,cAAM;AAAA,MACP;AAAA,IACD;AACA,OAAG,iBAAiB,SAAS,GAAG,eAAe;AAAA,EAChD;AAAA,EACA,QAAQ,IAAY,SAA2B;AAC9C,OAAG,WAAW,QAAQ;AAAA,EACvB;AAAA,EACA,cAAc,IAAY;AACzB,OAAG,oBAAoB,SAAS,GAAG,eAAe;AAAA,EACnD;AACD;AAEO,MAAM,QAAQ,qBAAqB,eAAe,MAAM;"}