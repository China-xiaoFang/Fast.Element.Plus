"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),l=require("element-plus"),t=require("@element-plus/icons-vue");require("../../../constants/index.js");const a=require("@fast-china/utils"),r=require("lodash-unified"),u=require("./common.js"),o=require("../../../constants/regex.js");function n(l){return"function"==typeof l||"[object Object]"===Object.prototype.toString.call(l)&&!e.isVNode(l)}const i=e.defineComponent({name:"FaCarNumber",props:{...l.inputProps,placeholder:{type:String,default:"请选择"}},emits:{"update:modelValue":e=>r.isString(e)||r.isNull(e),change:e=>r.isString(e)||r.isNull(e)},setup(r,{attrs:i,emit:d}){const s=e.reactive({value:a.withDefineType(),switchLetter:e.computed(()=>{var e;return(null==(e=s.value)?void 0:e.length)>=1}),disabledButton:e.computed(()=>{var e;return(null==(e=s.value)?void 0:e.length)>=8})}),c=e.ref(),p=e.inject(l.formContextKey,void 0),v=e.inject(l.formItemContextKey,void 0),m=e=>2===e.length?`${e} ● `:e.length>2?`${e.slice(0,2)} ● ${e.slice(2)}`:e,_=e=>{s.value??(s.value=""),s.value+=e},b=()=>{var e;0!==(null==(e=s.value)?void 0:e.length)&&(s.value=s.value.substring(0,s.value.length-1))},f=()=>{var e;let t=!1;7===s.value.length?t=o.RegExps.CarNumber.test(s.value):8===s.value.length&&(t=o.RegExps.NewEnergyCarNumber.test(s.value)),t?(d("update:modelValue",s.value),d("change",s.value),(null==v?void 0:v.prop)&&(null==p||p.validateField([v.prop]))):(null==v?void 0:v.prop)&&p?(d("update:modelValue",s.value),d("change",s.value),p.validateField([v.prop])):l.ElMessage.error("车牌号格式不正确"),null==(e=c.value)||e.hide()},g=()=>{s.value=null,d("update:modelValue",null),d("change",null),(null==v?void 0:v.prop)&&(null==p||p.validateField([v.prop]))};e.watch(()=>r.modelValue,e=>{s.value=e.toString()},{immediate:!0});const h=a.useProps(r,l.inputProps,["modelValue","readonly","formatter"]);a.useRender(()=>e.createVNode(l.ElPopover,{ref:c,width:"auto",popperClass:"fa-car-number__popover",trigger:"click",showArrow:!1,showAfter:0,hideAfter:0},{reference:()=>e.createVNode(l.ElInput,e.mergeProps(h.value,{class:"fa-car-number__input",modelValue:s.value,"onUpdate:modelValue":e=>s.value=e,readonly:!0,formatter:m}),null),default:()=>e.createVNode(e.Fragment,null,[e.createVNode("div",{class:["fa-car-number__popover__area",s.switchLetter?"fa-car-number__popover__hide":""]},[u.CarNumberArea.map(t=>e.createVNode(l.ElButton,{disabled:s.disabledButton,onClick:()=>_(t)},n(t)?t:{default:()=>[t]}))]),e.createVNode("div",{class:["fa-car-number__popover__digit-letter",s.switchLetter?"":"fa-car-number__popover__hide"]},[u.CarNumberDigit.map(t=>e.createVNode(l.ElButton,{disabled:s.disabledButton,onClick:()=>_(t)},n(t)?t:{default:()=>[t]})),u.CarNumberLetter.map(t=>e.createVNode(l.ElButton,{disabled:s.disabledButton,onClick:()=>_(t)},n(t)?t:{default:()=>[t]}))]),e.createVNode("div",{class:"fa-car-number__popover__btn"},[e.createVNode(l.ElButton,{class:"fa-car-number__popover__btn__clear",disabled:null===s.value||0===s.value.length,onClick:g},{default:()=>[e.createTextVNode("清除")]}),e.createVNode(l.ElButton,{class:"fa-car-number__popover__btn__back",type:"danger",icon:t.Back,disabled:null===s.value||0===s.value.length,onClick:b},null),e.createVNode(l.ElButton,{class:"fa-car-number__popover__btn__confirm",type:"primary",disabled:null===s.value||s.value.length<7,onClick:f},{default:()=>[e.createTextVNode("确认")]})])])}))}});exports.default=i;
//# sourceMappingURL=carNumber.js.map
