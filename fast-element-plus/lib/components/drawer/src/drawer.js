"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),o=require("@element-plus/icons-vue"),l=require("@fast-element-plus/icons-vue");require("../../../utils/index.js");const r=require("element-plus"),a=require("lodash-unified"),t=require("../../../utils/vue/props.js"),n=require("../../../utils/vue/slots.js"),s=require("../../../utils/vue/func.js"),i=require("../../../utils/console.js"),d=require("../../../utils/vue/useRender.js"),u=require("../../../utils/vue/expose.js"),c={...r.drawerProps,appendToBody:{type:Boolean,default:!0},draggable:{type:Boolean,default:!0},destroyOnClose:{type:Boolean,default:!0},showRefresh:{type:Boolean,default:!0},showFullscreen:{type:Boolean,default:!0},showCloseButton:{type:Boolean,default:!0},showConfirmButton:{type:Boolean,default:!0},disabledConfirmButton:Boolean,closeButtonText:{type:String,default:"取消"},confirmButtonText:{type:String,default:"确认"},hideFooter:Boolean,showBeforeClose:Boolean,afterOpen:{type:t.definePropType(Function)}},f={...r.drawerEmits,"update:modelValue":e=>a.isBoolean(e),confirmClick:()=>!0},h=e.defineComponent({name:"FaDrawer",props:c,emits:f,slots:n.makeSlots(),setup(a,{attrs:n,slots:c,emit:f,expose:h}){const _=e.reactive({loading:!1,visible:!1,fullscreen:!1,size:a.size??"30%",maxHeight:e.computed((()=>{let e="100vh";return a.withHeader&&(e+=" - var(--fa-drawer-header-height)"),a.hideFooter||(e+=" - var(--fa-drawer-footer-height)"),e+=" - 18px)",e})),refreshing:!1}),g=e.ref();let p;const m=o=>{_.visible=!0,p=o,e.nextTick((()=>{_.loading=!0,s.execFunction(a.afterOpen??o).then((()=>{f("open")})).catch((e=>{i.consoleError("FaDrawer",e),_.visible=!1})).finally((()=>{_.loading=!1}))}))},v=e=>{_.loading=!0,s.execFunction(e).then((()=>{f("close"),_.visible=!1})).catch((e=>{i.consoleError("FaDrawer",e)})).finally((()=>{_.loading=!1}))},w=()=>{_.refreshing=!0,_.loading=!0,setTimeout((()=>{_.refreshing=!1,m(p),r.ElMessage.success("刷新成功")}),500)},b=e=>{if(_.loading)return;if(document.querySelector(".el-image-viewer__wrapper"))return;const o=()=>{s.execFunction(a.beforeClose).then((()=>{f("close"),e()})).catch((e=>{i.consoleError("FaDialog",e)}))};a.showBeforeClose?r.ElMessageBox.confirm("确定关闭？",{type:"warning"}).then((()=>{o()})):o()},C=()=>{_.loading||(_.fullscreen=!_.fullscreen)},x=()=>{_.loading||f("confirmClick")},B=()=>{_.loading||v()};e.watch((()=>_.visible),(e=>{f("update:modelValue",e)}));const y=()=>{document.onmousemove=e=>{let o=document.body.clientWidth-e.pageX;const l=.2*document.body.clientWidth,r=.95*document.body.clientWidth;o=o>r?r:o<l?l:o,_.size=`${o}px`},document.onmouseup=()=>{document.onmousemove=document.onmouseup=null}},F=t.useProps(a,r.drawerProps,["modelValue","size","showClose","beforeClose"]);return d.useRender((()=>e.createVNode(r.ElDrawer,e.mergeProps(F.value,{ref:g,class:["fa-drawer",{"fa-drawer__fullscreen":_.fullscreen}],modelValue:_.visible,"onUpdate:modelValue":e=>_.visible=e,size:_.size,showClose:!1,beforeClose:b,onOpened:()=>f("opened"),onClosed:()=>f("closed"),onOpenAutoFocus:()=>f("openAutoFocus"),onCloseAutoFocus:()=>f("closeAutoFocus")}),{header:()=>e.createVNode(e.Fragment,null,[e.createVNode("div",{class:"fa-drawer__header-title"},[a.title,c.header&&c.header({loading:_.loading,close:B})]),a.showRefresh&&e.createVNode("div",{title:"刷新",class:["fa-drawer__header-icon",_.loading?"fa__click__disabled fa__click__disabled__cursor ":"fa__hover__twinkle"],onClick:w},[e.createVNode(r.ElIcon,{class:"icon"},{default:()=>[e.createVNode(o.Refresh,null,null)]})]),a.showFullscreen&&e.createVNode("div",{title:_.fullscreen?"关闭全屏显示":"全屏显示",class:["fa-drawer__header-icon",_.loading?"fa__click__disabled fa__click__disabled__cursor ":"fa__hover__twinkle"],onClick:C},[e.createVNode(r.ElIcon,null,{default:()=>[_.fullscreen?e.createVNode(l.FullScreenExit,null,null):e.createVNode(o.FullScreen,null,null)]})]),a.showClose&&e.createVNode("div",{title:"关闭",class:["fa-drawer__header-icon",_.loading?"fa__click__disabled fa__click__disabled__cursor ":"fa__hover__twinkle"],onClick:B},[e.createVNode(r.ElIcon,{class:"icon"},{default:()=>[e.createVNode(o.Close,null,null)]})])]),default:()=>e.createVNode(e.Fragment,null,[a.draggable&&e.createVNode("div",{class:"fa-drawer__draggable",onmousedown:y},null),e.withDirectives(e.createVNode(r.ElScrollbar,{class:"fa-drawer__scrollbar",wrapStyle:{"--fa-drawer-scrollbar__max-height":_.maxHeight,maxHeight:"var(--fa-drawer-scrollbar__max-height)"},"element-loading-text":"加载中..."},{default:()=>[_.refreshing?null:c.default&&c.default(_)]}),[[e.resolveDirective("loading"),_.loading]])]),...!a.hideFooter&&{footer:()=>e.createVNode(e.Fragment,null,[c.footer&&c.footer({loading:_.loading,close:B}),a.showCloseButton&&e.createVNode(r.ElButton,{disabled:_.loading,onClick:B},{default:()=>[a.closeButtonText]}),a.showConfirmButton&&e.createVNode(r.ElButton,{loading:_.loading,loadingIcon:o.Eleme,disabled:a.disabledConfirmButton,type:"primary",onClick:x},{default:()=>[_.loading?"加载中...":a.confirmButtonText]})])}}))),u.useExpose(h,{...e.computed((()=>{var e,o,l;return{handleClose:null==(e=g.value)?void 0:e.handleClose,afterEnter:null==(o=g.value)?void 0:o.afterEnter,afterLeave:null==(l=g.value)?void 0:l.afterLeave}})).value,loading:_.loading,visible:_.visible,open:m,close:v,refresh:w,doLoading:e=>{_.loading=!0,s.execFunction(e).then().catch((e=>{i.consoleError("FaDrawer",e)})).finally((()=>{_.loading=!1}))}})}});exports.default=h,exports.faDrawerEmits=f,exports.faDrawerProps=c;
//# sourceMappingURL=drawer.js.map
