{"version":3,"file":"form.js","sources":["../../../../../packages/components/form/src/form.tsx"],"sourcesContent":["import { computed, defineComponent, provide, reactive, ref } from \"vue\";\nimport { ElForm, formProps, useGlobalSize } from \"element-plus\";\nimport { FaLayoutGrid } from \"@fast-element-plus/components/layoutGrid\";\nimport { definePropType, makeSlots, useExpose, useProps, useRender } from \"@fast-china/utils\";\nimport { isNumber, isObject } from \"lodash-unified\";\nimport { formUtil } from \"../utils/form\";\nimport type { FaLayoutGridBreakPoint } from \"@fast-element-plus/components/layoutGrid\";\nimport type { FormInstance, FormItemContext, FormValidationResult } from \"element-plus\";\n\nexport const faFormProps = {\n\t...formProps,\n\t/** @description Width of label, e.g. `'50px'`. All its direct child form items will inherit this value. `auto` is supported. */\n\tlabelWidth: {\n\t\ttype: [String, Number],\n\t\tdefault: \"auto\",\n\t},\n\t/** @description Suffix of the label. */\n\tlabelSuffix: {\n\t\ttype: String,\n\t\tdefault: \"：\",\n\t},\n\t/** @description When validation fails, scroll to the first error form entry. */\n\tscrollToError: {\n\t\ttype: Boolean,\n\t\tdefault: true,\n\t},\n\t/** @description 详情From，会删除 FormItem 的 paddinfa-bottom */\n\tdetailForm: Boolean,\n\t/** @description Grid布局*/\n\tgrid: {\n\t\ttype: Boolean,\n\t\tdefault: true,\n\t},\n\t/** @description Grid布局列配置 */\n\tcols: {\n\t\ttype: definePropType<string | number | Record<FaLayoutGridBreakPoint, number>>([String, Number, Object]),\n\t\tdefault: (): Record<FaLayoutGridBreakPoint, number> => ({ xs: 1, sm: 2, md: 3, lg: 4, xl: 5 }),\n\t},\n};\n\ntype FaFormSlots = {\n\t/** @description 默认内容插槽 */\n\tdefault: unknown;\n};\n\nexport default defineComponent({\n\tname: \"FaForm\",\n\tprops: faFormProps,\n\tslots: makeSlots<FaFormSlots>(),\n\tsetup(props, { attrs, slots, expose }) {\n\t\tconst _globalSize = useGlobalSize();\n\n\t\tconst state = reactive({\n\t\t\tcols: computed(() => {\n\t\t\t\tif (isObject(props.cols)) {\n\t\t\t\t\treturn props.cols;\n\t\t\t\t} else {\n\t\t\t\t\tconst colsNumber = isNumber(props.cols) ? props.cols : Number(props.cols);\n\t\t\t\t\treturn { xs: 1, sm: colsNumber, md: colsNumber, lg: colsNumber, xl: colsNumber };\n\t\t\t\t}\n\t\t\t}),\n\t\t\tgap: computed(() => (_globalSize.value === \"small\" ? [15, 0] : [20, 0])),\n\t\t});\n\n\t\tconst formRef = ref<FormInstance>();\n\n\t\t// 注入 cols\n\t\tprovide(\"faFormCols\", state.cols);\n\n\t\tconst elFormProps = useProps(props, formProps);\n\n\t\tuseRender(() => (\n\t\t\t<ElForm\n\t\t\t\t{...elFormProps.value}\n\t\t\t\tref={formRef}\n\t\t\t\tclass={[\"fa-form\", `fa-form-${_globalSize.value}`, { [`fa-form-detail fa-form-detail_${_globalSize.value}`]: props.detailForm }]}\n\t\t\t>\n\t\t\t\t{{\n\t\t\t\t\tdefault: () =>\n\t\t\t\t\t\tprops.grid ? (\n\t\t\t\t\t\t\t<FaLayoutGrid collapsed gap={state.gap} cols={state.cols}>\n\t\t\t\t\t\t\t\t{slots.default && slots.default(state)}\n\t\t\t\t\t\t\t</FaLayoutGrid>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\tslots.default && slots.default(state)\n\t\t\t\t\t\t),\n\t\t\t\t}}\n\t\t\t</ElForm>\n\t\t));\n\n\t\treturn useExpose(expose, {\n\t\t\t/** @description 对整个表单的内容进行验证。 接收一个回调函数，或返回 Promise。 */\n\t\t\tvalidate: (): FormValidationResult => formUtil.validate(formRef),\n\t\t\t/** @description 验证具体的某个字段。 */\n\t\t\tvalidateField: computed(() => formRef.value?.validateField),\n\t\t\t/** @description 重置该表单项，将其值重置为初始值，并移除校验结果 */\n\t\t\tresetFields: computed(() => formRef.value?.resetFields),\n\t\t\t/** @description 清理某个字段的表单验证信息。 */\n\t\t\tclearValidate: computed(() => formRef.value?.clearValidate),\n\t\t\t/** @description 滚动到指定的字段 */\n\t\t\tscrollToField: computed(() => formRef.value?.scrollToField),\n\t\t\t/** @description 获取所有字段的 context */\n\t\t\tfields: computed(() => formRef.value?.fields as FormItemContext[]),\n\t\t\t/** @description 对整个表单的内容进行验证，带滚动。 接收一个回调函数，或返回 Promise。 */\n\t\t\tvalidateScrollToField: (): FormValidationResult => formUtil.validateScrollToField(formRef),\n\t\t});\n\t},\n});\n"],"names":["faFormProps","formProps","labelWidth","type","String","Number","default","labelSuffix","scrollToError","Boolean","detailForm","grid","cols","definePropType","Object","xs","sm","md","lg","xl","Form","name","props","slots","makeSlots","setup","attrs","expose","_globalSize","useGlobalSize","state","reactive","computed","isObject","colsNumber","isNumber","gap","value","formRef","ref","provide","elFormProps","useProps","useRender","_createVNode","ElForm","_mergeProps","class","FaLayoutGrid","collapsed","useExpose","validate","formUtil","validateField","resetFields","clearValidate","scrollToField","fields","validateScrollToField"],"mappings":"6RASaA,EAAc,IACvBC,EAAAA,UAEHC,WAAY,CACXC,KAAM,CAACC,OAAQC,QACfC,QAAS,QAGVC,YAAa,CACZJ,KAAMC,OACNE,QAAS,KAGVE,cAAe,CACdL,KAAMM,QACNH,SAAS,GAGVI,WAAYD,QAEZE,KAAM,CACLR,KAAMM,QACNH,SAAS,GAGVM,KAAM,CACLT,KAAMU,EAAAA,eAAyE,CAACT,OAAQC,OAAQS,SAChGR,QAASA,KAAAA,CAAiDS,GAAI,EAAGC,GAAI,EAAGC,GAAI,EAAGC,GAAI,EAAGC,GAAI,MAS5FC,oBAA+B,CAC9BC,KAAM,SACNC,MAAOtB,EACPuB,MAAOC,EAAAA,YACPC,KAAAA,CAAMH,GAAOI,MAAEA,EAAAA,MAAOH,EAAAA,OAAOI,IAC5B,MAAMC,EAAcC,EAAAA,gBAEdC,EAAQC,EAAAA,SAAS,CACtBnB,KAAMoB,EAAAA,SAAS,KACd,GAAIC,EAAAA,SAASX,EAAMV,MAClB,OAAOU,EAAMV,KACP,CACN,MAAMsB,EAAaC,WAASb,EAAMV,MAAQU,EAAMV,KAAOP,OAAOiB,EAAMV,MACpE,MAAO,CAAEG,GAAI,EAAGC,GAAIkB,EAAYjB,GAAIiB,EAAYhB,GAAIgB,EAAYf,GAAIe,EACrE,IAEDE,IAAKJ,EAAAA,SAAS,IAA6B,UAAtBJ,EAAYS,MAAoB,CAAC,GAAI,GAAK,CAAC,GAAI,MAG/DC,EAAUC,EAAAA,MAGhBC,UAAQ,aAAcV,EAAMlB,MAE5B,MAAM6B,EAAcC,EAAAA,SAASpB,EAAOrB,aAqBpC,OAnBA0C,EAAAA,UAAU,IAAAC,EAAAA,YAAAC,EAAAA,OAAAC,EAAAA,WAEJL,EAAYJ,MAAK,CAAAE,IAChBD,EAAOS,MACL,CAAC,UAAW,WAAWnB,EAAYS,QAAS,CAAE,CAAC,iCAAiCT,EAAYS,SAAUf,EAAMZ,eAAa,CAG/HJ,QAASA,IACRgB,EAAMX,KAAIiC,EAAAA,YAAAI,EAAAA,aAAA,CAAAC,WAAA,EAAAb,IACoBN,EAAMM,IAAGxB,KAAQkB,EAAMlB,MAAI,CAAAN,QAAAA,IAAA,CACtDiB,EAAMjB,SAAWiB,EAAMjB,QAAQwB,MAGjCP,EAAMjB,SAAWiB,EAAMjB,QAAQwB,MAM7BoB,EAAAA,UAAUvB,EAAQ,CAExBwB,SAAUA,IAA4BC,EAAAA,SAASD,SAASb,GAExDe,cAAerB,EAAAA,SAAS,WAAMM,OAAAA,OAAAA,EAAAA,EAAQD,YAARC,EAAAA,EAAee,gBAE7CC,YAAatB,EAAAA,SAAS,WAAMM,OAAAA,OAAAA,EAAAA,EAAQD,YAARC,EAAAA,EAAegB,cAE3CC,cAAevB,EAAAA,SAAS,WAAMM,OAAAA,OAAAA,EAAAA,EAAQD,YAARC,EAAAA,EAAeiB,gBAE7CC,cAAexB,EAAAA,SAAS,WAAMM,OAAAA,OAAAA,EAAAA,EAAQD,YAARC,EAAAA,EAAekB,gBAE7CC,OAAQzB,EAAAA,SAAS,WAAMM,OAAAA,OAAAA,EAAAA,EAAQD,YAARC,EAAAA,EAAemB,SAEtCC,sBAAuBA,IAA4BN,WAASM,sBAAsBpB,IAEpF"}