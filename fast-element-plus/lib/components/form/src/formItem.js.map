{"version":3,"file":"formItem.js","sources":["../../../../../packages/components/form/src/formItem.tsx"],"sourcesContent":["import { Fragment, computed, defineComponent, inject, ref } from \"vue\";\nimport { ElFormItem, formItemProps } from \"element-plus\";\nimport { FaFormItemTip } from \"@fast-element-plus/components/formItemTip\";\nimport { FaLayoutGridItem } from \"@fast-element-plus/components/layoutGrid\";\nimport { makeSlots, useExpose, useProps, useRender } from \"@fast-china/utils\";\nimport { isNumber } from \"lodash-unified\";\nimport type { FormItemInstance } from \"element-plus\";\nimport type { Ref, VNode } from \"vue\";\n\nexport const faFormItemProps = {\n\t...formItemProps,\n\t/** @description Label tips 提示 */\n\ttips: String,\n\t/** @description Grid 布局 */\n\tgrid: {\n\t\ttype: Boolean,\n\t\tdefault: true,\n\t},\n\t/** @description 偏移量 */\n\toffset: {\n\t\ttype: [String, Number],\n\t\tdefault: 0,\n\t},\n\t/** @description 栅格跨度 */\n\tspan: {\n\t\ttype: [String, Number],\n\t},\n\t/** @description 独占一行。如果设置 span 则无效 */\n\trow: Boolean,\n};\n\ntype FaFormItemSlots = {\n\t/** @description 默认内容插槽 */\n\tdefault: never;\n\t/** @description 标签位置显示的内容 */\n\tlabel: { label: string };\n\t/** @description 验证错误信息的显示内容 */\n\terror: { error: string };\n};\n\nexport default defineComponent({\n\tname: \"FaFormItem\",\n\tprops: faFormItemProps,\n\tslots: makeSlots<FaFormItemSlots>(),\n\tsetup(props, { attrs, slots, emit, expose }) {\n\t\tconst formItemRef = ref<FormItemInstance>();\n\n\t\tconst cols = inject<Ref<number>>(\"cols\", ref(4));\n\n\t\t// 获取响应式设置\n\t\tconst getResponsive = (): {\n\t\t\tspan?: number;\n\t\t\toffset?: number;\n\t\t} => {\n\t\t\tif (!props.grid) return {};\n\t\t\tif (props.span) {\n\t\t\t\treturn {\n\t\t\t\t\tspan: isNumber(props.span) ? props.span : Number(props.span),\n\t\t\t\t\toffset: isNumber(props.offset) ? props.offset : Number(props.offset),\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tconst result = {\n\t\t\t\t\tspan: 1,\n\t\t\t\t\toffset: isNumber(props.offset) ? props.offset : Number(props.offset),\n\t\t\t\t};\n\t\t\t\tif (props.row) {\n\t\t\t\t\tresult.span = cols.value;\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t}\n\t\t};\n\n\t\tconst elFormItemProps = useProps(props, formItemProps);\n\n\t\tconst ParcelComponent = props.grid ? FaLayoutGridItem : Fragment;\n\n\t\tuseRender(() => (\n\t\t\t<ParcelComponent {...getResponsive()}>\n\t\t\t\t<ElFormItem ref={formItemRef} {...elFormItemProps.value}>\n\t\t\t\t\t{{\n\t\t\t\t\t\tdefault: () => slots.default(),\n\t\t\t\t\t\t...(slots.label && !props.tips && { label: ({ label }: { label: string }): VNode[] => slots.label({ label }) }),\n\t\t\t\t\t\t...(slots.label &&\n\t\t\t\t\t\t\tprops.tips && {\n\t\t\t\t\t\t\t\tlabel: ({ label }: { label: string }): VNode[] => (\n\t\t\t\t\t\t\t\t\t<FaFormItemTip>\n\t\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\t\tlabel: () => slots.label({ label }),\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t</FaFormItemTip>\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t...(!slots.label &&\n\t\t\t\t\t\t\tprops.tips && {\n\t\t\t\t\t\t\t\tlabel: ({ label }: { label: string }): VNode[] => <FaFormItemTip label={label ?? props.label} tips={props.tips} />,\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t...(slots.error && { error: ({ error }: { error: string }): VNode[] => slots.error({ error }) }),\n\t\t\t\t\t}}\n\t\t\t\t</ElFormItem>\n\t\t\t</ParcelComponent>\n\t\t));\n\n\t\treturn useExpose(expose, {\n\t\t\t/** @description 表单项大小 */\n\t\t\tsize: computed(() => formItemRef.value?.size),\n\t\t\t/** @description 校验消息 */\n\t\t\tvalidateMessage: computed(() => formItemRef.value?.validateMessage),\n\t\t\t/** @description 校验状态 */\n\t\t\tvalidateState: computed(() => formItemRef.value?.validateState),\n\t\t\t/** @description 验证表单项 */\n\t\t\tvalidate: computed(() => formItemRef.value?.validate),\n\t\t\t/** @description 移除该表单项的校验结果 */\n\t\t\tclearValidate: computed(() => formItemRef.value?.clearValidate),\n\t\t\t/** @description 对该表单项进行重置，将其值重置为初始值并移除校验结果 */\n\t\t\tresetField: computed(() => formItemRef.value?.resetField),\n\t\t});\n\t},\n});\n"],"names":["faFormItemProps","formItemProps","tips","String","grid","type","Boolean","default","offset","Number","span","row","FormItem","name","props","slots","makeSlots","setup","attrs","emit","expose","formItemRef","ref","cols","inject","elFormItemProps","useProps","ParcelComponent","FaLayoutGridItem","Fragment","useRender","_createVNode","getResponsive","isNumber","result","value","ElFormItem","_mergeProps","label","FaFormItemTip","error","useExpose","size","computed","validateMessage","validateState","validate","clearValidate","resetField"],"mappings":"uSASaA,EAAkB,IAC3BC,EAAAA,cAEHC,KAAMC,OAENC,KAAM,CACLC,KAAMC,QACNC,SAAS,GAGVC,OAAQ,CACPH,KAAM,CAACF,OAAQM,QACfF,QAAS,GAGVG,KAAM,CACLL,KAAM,CAACF,OAAQM,SAGhBE,IAAKL,SAYNM,oBAA+B,CAC9BC,KAAM,aACNC,MAAOd,EACPe,MAAOC,EAAAA,YACPC,KAAAA,CAAMH,GAAOI,MAAEA,EAAAA,MAAOH,EAAAA,KAAOI,EAAAA,OAAMC,IAClC,MAAMC,EAAcC,EAAAA,MAEdC,EAAOC,EAAAA,OAAoB,OAAQF,EAAAA,IAAI,IAyBvCG,EAAkBC,EAAAA,SAASZ,EAAOb,iBAElC0B,EAAkBb,EAAMV,KAAOwB,EAAAA,iBAAmBC,EAAAA,SA4BxD,OA1BAC,EAAAA,UAAU,IAAAC,EAAAA,YAAAJ,EA1BYK,MAIrB,IAAKlB,EAAMV,KAAM,MAAO,CAAA,EACxB,GAAIU,EAAMJ,KACT,MAAO,CACNA,KAAMuB,EAAAA,SAASnB,EAAMJ,MAAQI,EAAMJ,KAAOD,OAAOK,EAAMJ,MACvDF,OAAQyB,EAAAA,SAASnB,EAAMN,QAAUM,EAAMN,OAASC,OAAOK,EAAMN,SAExD,CACN,MAAM0B,EAAS,CACdxB,KAAM,EACNF,OAAQyB,EAAAA,SAASnB,EAAMN,QAAUM,EAAMN,OAASC,OAAOK,EAAMN,SAK9D,OAHIM,EAAMH,MACTuB,EAAOxB,KAAOa,EAAKY,OAEbD,CACR,GAQqBF,GAAe,CAAAzB,QAAAA,IAAA,CAAAwB,cAAAK,EAAAA,WAAAC,EAAAA,WAAA,CAAAf,IAClBD,GAAiBI,EAAgBU,OAAK,CAErD5B,QAASA,IAAMQ,EAAMR,aACjBQ,EAAMuB,QAAUxB,EAAMZ,MAAQ,CAAEoC,MAAOA,EAAGA,WAAwCvB,EAAMuB,MAAM,CAAEA,cAChGvB,EAAMuB,OACTxB,EAAMZ,MAAQ,CACboC,MAAOA,EAAGA,WAA0BP,EAAAA,YAAAQ,EAAAA,cAAA,KAAA,CAGjCD,MAAOA,IAAMvB,EAAMuB,MAAM,CAAEA,iBAK3BvB,EAAMuB,OACVxB,EAAMZ,MAAQ,CACboC,MAAOA,EAAGA,WAA0BP,EAAAA,YAAAQ,EAAAA,cAAA,CAAAD,MAAoCA,GAASxB,EAAMwB,MAAKpC,KAAQY,EAAMZ,MAAI,UAE5Ga,EAAMyB,OAAS,CAAEA,MAAOA,EAAGA,WAAwCzB,EAAMyB,MAAM,CAAEA,iBAMlFC,EAAAA,UAAUrB,EAAQ,CAExBsB,KAAMC,EAAAA,SAAS,IAAMtB,EAAYc,OAAOO,MAExCE,gBAAiBD,EAAAA,SAAS,IAAMtB,EAAYc,OAAOS,iBAEnDC,cAAeF,EAAAA,SAAS,IAAMtB,EAAYc,OAAOU,eAEjDC,SAAUH,EAAAA,SAAS,IAAMtB,EAAYc,OAAOW,UAE5CC,cAAeJ,EAAAA,SAAS,IAAMtB,EAAYc,OAAOY,eAEjDC,WAAYL,EAAAA,SAAS,IAAMtB,EAAYc,OAAOa,aAEhD"}