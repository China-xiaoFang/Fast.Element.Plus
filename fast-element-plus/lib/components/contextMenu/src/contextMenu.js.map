{"version":3,"file":"contextMenu.js","sources":["../../../../../packages/components/contextMenu/src/contextMenu.tsx"],"sourcesContent":["import { Transition, computed, defineComponent, onMounted, reactive } from \"vue\";\nimport { useGlobalSize } from \"element-plus\";\nimport { FaIcon } from \"@fast-element-plus/components/icon\";\nimport { definePropType, useExpose, useRender } from \"@fast-china/utils\";\nimport { useEventListener } from \"@vueuse/core\";\nimport { isObject } from \"lodash-unified\";\nimport type { FaContextMenuData } from \"./contextMenu.type\";\n\nexport default defineComponent({\n\tname: \"FaContextMenu\",\n\tprops: {\n\t\t/** @description 数据 */\n\t\tdata: {\n\t\t\ttype: definePropType<FaContextMenuData[]>(Array),\n\t\t\tdefault: () => [],\n\t\t},\n\t},\n\temits: {\n\t\t/** @description 点击事件 */\n\t\tclick: (event: MouseEvent, data: FaContextMenuData) => event instanceof MouseEvent && isObject(data),\n\t},\n\tsetup(props, { emit, expose }) {\n\t\tconst _globalSize = useGlobalSize();\n\n\t\tconst state = reactive({\n\t\t\tvisible: false,\n\t\t\taxis: {\n\t\t\t\tx: 0,\n\t\t\t\ty: 0,\n\t\t\t},\n\t\t});\n\n\t\tconst handleClick = (event: MouseEvent, data: FaContextMenuData): void => {\n\t\t\tif (data?.disabled) return;\n\t\t\tdata?.click && data.click(event, data);\n\t\t\temit(\"click\", event, data);\n\t\t};\n\n\t\tconst open = (axis: { x: number; y: number } = { x: 0, y: 0 }): void => {\n\t\t\tstate.axis = axis;\n\t\t\tstate.visible = true;\n\t\t};\n\n\t\tconst close = (): void => {\n\t\t\tstate.visible = false;\n\t\t};\n\n\t\tonMounted(() => {\n\t\t\tuseEventListener(document, \"click\", close);\n\t\t});\n\n\t\tuseRender(() => (\n\t\t\t<Transition name=\"el-zoom-in-center\">\n\t\t\t\t<div\n\t\t\t\t\tclass={[\"fa-context-menu\", `fa-context-menu-${_globalSize.value}`, \"el-popper el-dropdown__popper\"]}\n\t\t\t\t\tstyle={{ top: `${state.axis.y + 5}px`, left: `${state.axis.x + 14}px` }}\n\t\t\t\t\tvShow={state.visible}\n\t\t\t\t\tkey={Math.random()}\n\t\t\t\t>\n\t\t\t\t\t<ul class=\"el-dropdown-menu\">\n\t\t\t\t\t\t{props.data\n\t\t\t\t\t\t\t.filter((f) => !f.hide)\n\t\t\t\t\t\t\t.map((item) => (\n\t\t\t\t\t\t\t\t<li\n\t\t\t\t\t\t\t\t\tclass={[\"el-dropdown-menu__item\", item?.disabled === true ? \"is-disabled\" : \"\"]}\n\t\t\t\t\t\t\t\t\ttabIndex=\"-1\"\n\t\t\t\t\t\t\t\t\tonClick={(event: MouseEvent) => {\n\t\t\t\t\t\t\t\t\t\thandleClick(event, item);\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{item?.icon ? <FaIcon name={item?.icon} /> : null}\n\t\t\t\t\t\t\t\t\t<span>{item.label}</span>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t</Transition>\n\t\t));\n\n\t\treturn useExpose(expose, {\n\t\t\t/** @description 是否显示 */\n\t\t\tvisible: computed(() => state.visible),\n\t\t\t/** @description 打开菜单 */\n\t\t\topen,\n\t\t\t/** @description 关闭菜单 */\n\t\t\tclose,\n\t\t});\n\t},\n});\n"],"names":["ContextMenu","name","props","data","type","definePropType","Array","default","emits","click","event","MouseEvent","isObject","setup","emit","expose","_globalSize","useGlobalSize","state","reactive","visible","axis","x","y","close","onMounted","useEventListener","document","useRender","_createVNode","Transition","_withDirectives","class","value","style","top","left","key","Math","random","filter","f","hide","map","item","disabled","tabIndex","onClick","handleClick","icon","FaIcon","label","_vShow","useExpose","computed","open"],"mappings":"mRAQAA,oBAA+B,CAC9BC,KAAM,gBACNC,MAAO,CAENC,KAAM,CACLC,KAAMC,EAAAA,eAAoCC,OAC1CC,QAASA,IAAM,KAGjBC,MAAO,CAENC,MAAOA,CAACC,EAAmBP,IAA4BO,aAAiBC,YAAcC,EAAAA,SAAST,IAEhGU,KAAAA,CAAMX,GAAOY,KAAEA,EAAAA,OAAMC,IACpB,MAAMC,EAAcC,EAAAA,gBAEdC,EAAQC,EAAAA,SAAS,CACtBC,SAAS,EACTC,KAAM,CACLC,EAAG,EACHC,EAAG,KAeCC,EAAQA,KACbN,EAAME,SAAU,GAmCjB,OAhCAK,EAAAA,UAAU,KACTC,mBAAiBC,SAAU,QAASH,KAGrCI,YAAU,IAAAC,EAAAA,YAAAC,aAAA,CAAA7B,KAAA,qBAAA,CAAAM,QAAAA,IAAA,CAAAwB,iBAAAF,EAAAA,YAAA,MAAA,CAAAG,MAGA,CAAC,kBAAmB,mBAAmBhB,EAAYiB,QAAS,iCAAgCC,MAC5F,CAAEC,IAAK,GAAGjB,EAAMG,KAAKE,EAAI,MAAOa,KAAM,GAAGlB,EAAMG,KAAKC,EAAI,QAAQe,IAElEC,KAAKC,UAAQ,CAAAV,EAAAA,YAAA,KAAA,CAAAG,MAAA,oBAAA,CAGhB9B,EAAMC,KACLqC,OAAQC,IAAOA,EAAEC,MACjBC,IAAKC,GAAIf,EAAAA,YAAA,KAAA,CAAAG,MAED,CAAC,0BAA6C,WAAnBY,WAAMC,UAAoB,cAAgB,IAAGC,SAAA,KAAAC,QAErErC,IAlCGsC,EAACtC,EAAmBP,YACnCA,WAAM0C,aACV1C,MAAAA,OAAAA,EAAAA,EAAMM,QAASN,EAAKM,MAAMC,EAAOP,GACjCW,EAAK,QAASJ,EAAOP,KAgCd6C,CAAYtC,EAAOkC,KACnB,EAEAA,MAAAA,OAAAA,EAAAA,EAAMK,MAAIpB,EAAAA,YAAAqB,EAAAA,OAAA,CAAAjD,KAAiB2C,MAAAA,OAAAA,EAAAA,EAAMK,MAAI,MAAO,KAAIpB,EAAAA,YAAA,OAAA,KAAA,CAC1Ce,EAAKO,eAEZ,CAAA,CAAAC,EAAAA,MAjBGlC,EAAME,eAuBTiC,EAAAA,UAAUtC,EAAQ,CAExBK,QAASkC,EAAAA,SAAS,IAAMpC,EAAME,SAE9BmC,KA7CYA,CAAClC,EAAiC,CAAEC,EAAG,EAAGC,EAAG,MACzDL,EAAMG,KAAOA,EACbH,EAAME,SAAU,GA6ChBI,SAEF"}