"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),o=require("element-plus"),l=require("@element-plus/icons-vue"),a=require("@fast-element-plus/icons-vue"),t=require("@fast-china/utils"),n=require("lodash-unified"),i={...o.dialogProps,alignCenter:{type:Boolean,default:!0},appendToBody:{type:Boolean,default:!0},draggable:{type:Boolean,default:!0},destroyOnClose:{type:Boolean,default:!0},overflow:{type:Boolean,default:!0},top:{type:String,default:"5vh"},width:{type:[String,Number],default:"90%"},showRefresh:{type:Boolean,default:!0},showFullscreen:{type:Boolean,default:!0},showCloseButton:{type:Boolean,default:!0},showConfirmButton:{type:Boolean,default:!0},disabledConfirmButton:Boolean,closeButtonText:{type:String,default:"取消"},confirmButtonText:{type:String,default:"确认"},hideFooter:Boolean,fillHeight:Boolean,showBeforeClose:Boolean,afterOpen:{type:t.definePropType(Function)}},r={...o.dialogEmits,"update:modelValue":e=>n.isBoolean(e),confirmClick:()=>!0},s=e.defineComponent({name:"FaDialog",props:i,emits:r,slots:t.makeSlots(),setup(n,{attrs:i,slots:r,emit:s,expose:d}){const u=o.useGlobalSize(),c=e.reactive({loading:!1,visible:!1,fullscreen:!1,refreshing:!1}),f=e.ref();let g;const p=o=>{c.visible=!0,g=o,e.nextTick(()=>{c.loading=!0,t.execFunction(n.afterOpen??o).then(()=>{s("open")}).catch(e=>{t.consoleError("FaDialog",e),c.visible=!1}).finally(()=>{c.loading=!1})})},_=e=>{c.loading=!0,t.execFunction(e).then(()=>{s("close"),c.visible=!1}).catch(e=>{t.consoleError("FaDialog",e)}).finally(()=>{c.loading=!1})},h=()=>{c.loading||(c.refreshing=!0,c.loading=!0,setTimeout(()=>{c.refreshing=!1,p(g),o.ElMessage.success("刷新成功")},500))},m=e=>{if(c.loading)return;if(document.querySelector(".el-image-viewer__wrapper"))return;const l=()=>{t.execFunction(n.beforeClose).then(()=>{s("close"),e()}).catch(e=>{t.consoleError("FaDialog",e)})};n.showBeforeClose?o.ElMessageBox.confirm("确定关闭？",{type:"warning"}).then(()=>{l()}):l()},v=()=>{c.loading||(c.fullscreen=!c.fullscreen)},B=()=>{c.loading||s("confirmClick")},C=()=>{c.loading||_()};e.watch(()=>c.visible,e=>{s("update:modelValue",e)});const b=t.useProps(n,o.dialogProps,["modelValue","fullscreen","showClose","beforeClose"]);return t.useRender(()=>e.createVNode(o.ElDialog,e.mergeProps(b.value,{ref:f,class:["fa-dialog",`fa-dialofa-${u.value}`,{"fa-dialofa__fill-height":n.fillHeight,"fa-dialofa__fullscreen":c.fullscreen}],modelValue:c.visible,"onUpdate:modelValue":e=>c.visible=e,fullscreen:c.fullscreen,showClose:!1,beforeClose:m,onOpened:()=>s("opened"),onClosed:()=>s("closed"),onOpenAutoFocus:()=>s("openAutoFocus"),onCloseAutoFocus:()=>s("closeAutoFocus")}),{header:()=>e.createVNode(e.Fragment,null,[e.createVNode("div",{class:"fa-dialofa__header-title"},[n.title,r.header&&r.header({loading:c.loading,close:C})]),n.showRefresh&&e.createVNode("div",{title:"刷新",class:["fa-dialofa__header-icon",c.loading?"fa__click__disabled fa__click__disabled__cursor ":"fa__hover__twinkle"],onClick:h},[e.createVNode(o.ElIcon,null,{default:()=>[e.createVNode(l.Refresh,null,null)]})]),n.showFullscreen&&e.createVNode("div",{title:c.fullscreen?"关闭全屏显示":"全屏显示",class:["fa-dialofa__header-icon",c.loading?"fa__click__disabled fa__click__disabled__cursor ":"fa__hover__twinkle"],onClick:v},[e.createVNode(o.ElIcon,null,{default:()=>[c.fullscreen?e.createVNode(a.FullScreenExit,null,null):e.createVNode(l.FullScreen,null,null)]})]),n.showClose&&e.createVNode("div",{title:"关闭",class:["fa-dialofa__header-icon",c.loading?"fa__click__disabled fa__click__disabled__cursor ":"fa__hover__twinkle"],onClick:C},[e.createVNode(o.ElIcon,null,{default:()=>[e.createVNode(l.Close,null,null)]})])]),default:()=>e.withDirectives(e.createVNode(o.ElScrollbar,{"element-loading-text":"加载中..."},{default:()=>[!c.refreshing&&r.default&&r.default(c)]}),[[e.resolveDirective("loading"),c.loading]]),...!n.hideFooter&&{footer:()=>e.createVNode(e.Fragment,null,[r.footer&&r.footer({loading:c.loading,close:C}),n.showCloseButton&&e.createVNode(o.ElButton,{disabled:c.loading,onClick:C},{default:()=>[n.closeButtonText]}),n.showConfirmButton&&e.createVNode(o.ElButton,{loading:c.loading,loadingIcon:l.Eleme,disabled:n.disabledConfirmButton,type:"primary",onClick:B},{default:()=>[c.loading?"加载中...":n.confirmButtonText]})])}})),t.useExpose(d,{dialogContentRef:e.computed(()=>{var e;return null==(e=f.value)?void 0:e.dialogContentRef}),resetPosition:e.computed(()=>{var e;return null==(e=f.value)?void 0:e.resetPosition}),loading:e.computed(()=>c.loading),visible:e.computed(()=>c.visible),open:p,close:_,refresh:h,doLoading:e=>{c.loading=!0,t.execFunction(e).then().catch(e=>{t.consoleError("FaDialog",e)}).finally(()=>{c.loading=!1})}})}});exports.default=s,exports.faDialogEmits=r,exports.faDialogProps=i;
//# sourceMappingURL=dialog.js.map
