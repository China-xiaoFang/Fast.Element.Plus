"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),l=require("@element-plus/icons-vue"),o=require("@fast-element-plus/icons-vue");require("../../../utils/index.js");const t=require("element-plus"),i=require("lodash-unified"),a=require("../../../utils/vue/props.js"),n=require("../../../utils/vue/slots.js"),r=require("../../../utils/vue/func.js"),s=require("../../../utils/console.js"),d=require("../../../utils/vue/useRender.js"),u=require("../../../utils/vue/expose.js"),c={...t.dialogProps,appendToBody:{type:Boolean,default:!0},draggable:{type:Boolean,default:!0},destroyOnClose:{type:Boolean,default:!0},overflow:{type:Boolean,default:!0},height:{type:[String,Number]},showRefresh:{type:Boolean,default:!0},showFullscreen:{type:Boolean,default:!0},showCloseButton:{type:Boolean,default:!0},showConfirmButton:{type:Boolean,default:!0},disabledConfirmButton:Boolean,closeButtonText:{type:String,default:"取消"},confirmButtonText:{type:String,default:"确认"},hideFooter:Boolean,fillHeight:Boolean,showBeforeClose:Boolean,afterOpen:{type:a.definePropType(Function)}},f={...t.dialogEmits,"update:modelValue":e=>i.isBoolean(e),confirmClick:()=>!0},g=e.defineComponent({name:"FaDialog",props:c,emits:f,slots:n.makeSlots(),setup(n,{attrs:c,slots:f,emit:g,expose:h}){const _=e.reactive({loading:!1,visible:!1,fullscreen:!1,width:e.computed((()=>n.width?i.isNumber(n.width)?`${n.width}px`:n.width:"auto")),height:e.computed((()=>n.height?i.isNumber(n.height)?`${n.height}px`:n.height:"auto")),maxHeight:e.computed((()=>{let e="calc(";return _.fullscreen?e+="100vh":e+="var(--fa-dialog-height)",e+=" - var(--fa-dialog-header-height)",n.hideFooter||(e+=" - var(--fa-dialog-footer-height)"),e+=" - 18px)",e})),refreshing:!1}),p=e.ref();let m;const v=l=>{_.visible=!0,m=l,e.nextTick((()=>{_.loading=!0,r.execFunction(n.afterOpen??l).then((()=>{g("open")})).catch((e=>{s.consoleError("FaDialog",e),_.visible=!1})).finally((()=>{_.loading=!1}))}))},b=e=>{_.loading=!0,r.execFunction(e).then((()=>{g("close"),_.visible=!1})).catch((e=>{s.consoleError("FaDialog",e)})).finally((()=>{_.loading=!1}))},w=()=>{_.refreshing=!0,_.loading=!0,setTimeout((()=>{_.refreshing=!1,v(m),t.ElMessage.success("刷新成功")}),500)},x=e=>{if(_.loading)return;if(document.querySelector(".el-image-viewer__wrapper"))return;const l=()=>{r.execFunction(n.beforeClose).then((()=>{g("close"),e()})).catch((e=>{s.consoleError("FaDialog",e)}))};n.showBeforeClose?t.ElMessageBox.confirm("确定关闭？",{type:"warning"}).then((()=>{l()})):l()},B=()=>{_.loading||(_.fullscreen=!_.fullscreen)},C=()=>{_.loading||g("confirmClick")},y=()=>{_.loading||b()};e.watch((()=>_.visible),(e=>{g("update:modelValue",e)}));const F=a.useProps(n,t.dialogProps,["modelValue","fullscreen","showClose","beforeClose"]);return d.useRender((()=>e.createVNode(t.ElDialog,e.mergeProps(F.value,{ref:p,class:["fa-dialog",{"fa-dialog__fill-height":n.fillHeight,"fa-dialog__fullscreen":_.fullscreen}],style:{width:_.width,maxWidth:_.width,height:_.height,maxHeight:_.height},modelValue:_.visible,"onUpdate:modelValue":e=>_.visible=e,fullscreen:_.fullscreen,showClose:!1,beforeClose:x,onOpened:()=>g("opened"),onClosed:()=>g("closed"),onOpenAutoFocus:()=>g("openAutoFocus"),onCloseAutoFocus:()=>g("closeAutoFocus")}),{header:()=>e.createVNode(e.Fragment,null,[e.createVNode("div",{class:"fa-dialog__header-title"},[n.title,f.header&&f.header({loading:_.loading,close:y})]),n.showRefresh&&e.createVNode("div",{title:"刷新",class:["fa-dialog__header-icon",_.loading?"fa__click__disabled fa__click__disabled__cursor ":"fa__hover__twinkle"],onClick:w},[e.createVNode(t.ElIcon,null,{default:()=>[e.createVNode(l.Refresh,null,null)]})]),n.showFullscreen&&e.createVNode("div",{title:_.fullscreen?"关闭全屏显示":"全屏显示",class:["fa-dialog__header-icon",_.loading?"fa__click__disabled fa__click__disabled__cursor ":"fa__hover__twinkle"],onClick:B},[e.createVNode(t.ElIcon,null,{default:()=>[_.fullscreen?e.createVNode(o.FullScreenExit,null,null):e.createVNode(l.FullScreen,null,null)]})]),n.showClose&&e.createVNode("div",{title:"关闭",class:["fa-dialog__header-icon",_.loading?"fa__click__disabled fa__click__disabled__cursor ":"fa__hover__twinkle"],onClick:y},[e.createVNode(t.ElIcon,null,{default:()=>[e.createVNode(l.Close,null,null)]})])]),default:()=>e.withDirectives(e.createVNode(t.ElScrollbar,{class:"fa-dialog__scrollbar",wrapStyle:{"--fa-dialog-scrollbar__max-height":_.maxHeight,maxHeight:"var(--fa-dialog-scrollbar__max-height)"},"element-loading-text":"加载中..."},{default:()=>[_.refreshing?null:f.default&&f.default(_)]}),[[e.resolveDirective("loading"),_.loading]]),...!n.hideFooter&&{footer:()=>e.createVNode(e.Fragment,null,[f.footer&&f.footer({loading:_.loading,close:y}),n.showCloseButton&&e.createVNode(t.ElButton,{disabled:_.loading,onClick:y},{default:()=>[n.closeButtonText]}),n.showConfirmButton&&e.createVNode(t.ElButton,{loading:_.loading,loadingIcon:l.Eleme,disabled:n.disabledConfirmButton,type:"primary",onClick:C},{default:()=>[_.loading?"加载中...":n.confirmButtonText]})])}}))),u.useExpose(h,{...e.computed((()=>{var e,l;return{dialogContentRef:null==(e=p.value)?void 0:e.dialogContentRef,resetPosition:null==(l=p.value)?void 0:l.resetPosition}})).value,loading:_.loading,visible:_.visible,open:v,close:b,refresh:w,doLoading:e=>{_.loading=!0,r.execFunction(e).then().catch((e=>{s.consoleError("FaDialog",e)})).finally((()=>{_.loading=!1}))}})}});exports.default=g,exports.faDialogEmits=f,exports.faDialogProps=c;
//# sourceMappingURL=dialog.js.map
