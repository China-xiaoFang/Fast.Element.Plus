"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),l=require("element-plus"),a=require("@element-plus/icons-vue"),t=require("../../upload/src/useUpload.js");require("../../../constants/index.js");const i=require("@fast-china/utils"),r=require("lodash-unified"),o=require("../../../constants/mime.js"),u={...l.uploadProps,accept:{type:String,default:()=>o.FaMimeType.Image},listType:{type:i.definePropType(String),default:"picture-card"},multiple:{type:Boolean,default:!0},limit:{type:Number,default:9},modelValue:i.definePropType([String,Array]),maxSize:{type:[String,Number],default:2048},uploadApi:{type:i.definePropType(Function)},uploadUrl:String},d={"update:modelValue":e=>r.isString(e)||r.isArray(e)||r.isNull(e),"update:fileList":e=>r.isArray(e),change:e=>r.isString(e)||r.isArray(e)||r.isNull(e)},s=e.defineComponent({name:"FaUploadImages",props:u,emits:d,slots:i.makeSlots(),setup(r,{attrs:o,slots:u,emit:d,expose:s}){const{fileList:n,loading:p,formContext:c,maxSizeMB:m,handleValue:v,handleHttpRequest:f,handleOnSuccess:g,handleOnError:N,handleOnExceed:V,handleOnUpload:h}=t.useUpload("FaUploadImages","图片",r,d,{maxSize:r.maxSize,uploadApi:r.uploadApi,uploadUrl:r.uploadUrl}),S=e.computed(()=>r.disabled||(null==c?void 0:c.disabled)),x=e.reactive({uploadKey:`fa-upload-images__${i.stringUtil.generateRandomString(8)}`,preview:!1,previewIndex:-1,previewList:[]}),y=e.ref(),_=()=>{const e=document.querySelector(`.${x.uploadKey} .el-upload__input`);e&&e.dispatchEvent(new MouseEvent("click"))},w=e=>!!h(e)&&(!r.beforeUpload||r.beforeUpload(e)),E=i.useProps(r,l.uploadProps,["fileList","disabled","httpRequest","beforeUpload","onExceed","onSuccess","onError"]);return i.useRender(()=>e.createVNode(e.Fragment,null,[e.withDirectives(e.createVNode(l.ElUpload,e.mergeProps(E.value,{ref:y,class:["fa-upload-images",x.uploadKey,{"fa-upload-images__hidden-upload":n.value.length>=r.limit}],fileList:n.value,"onUpdate:fileList":e=>n.value=e,disabled:S.value,httpRequest:f,beforeUpload:w,onExceed:V,onSuccess:g,onError:N}),{default:()=>n.value.length<r.limit&&u.default?u.default():e.createVNode(l.ElIcon,null,{default:()=>[e.createVNode(a.Plus,null,null)]}),tip:()=>e.createVNode("div",{class:"el-upload__tip"},[e.createTextVNode("files with a size less than "),m.toString(),e.createTextVNode("MB")]),file:({file:t,index:i})=>e.createVNode("div",null,[e.createVNode("img",{class:"el-upload-list__item-thumbnail",src:t.url},null),e.createVNode("span",{class:"el-upload-list__item-actions"},[e.createVNode("span",{class:"el-upload-list__item-preview",onClick:()=>{return e=t,x.previewIndex=n.value.findIndex(l=>l.url===e.url),x.previewList=n.value.map(e=>e.url),void(x.preview=!0);var e},title:"查看"},[e.createVNode(l.ElIcon,null,{default:()=>[e.createVNode(a.ZoomIn,null,null)]})]),!S.value&&e.createVNode(e.Fragment,null,[e.createVNode("span",{class:"el-upload-list__item-icon",onClick:_,title:"编辑"},[e.createVNode(l.ElIcon,null,{default:()=>[e.createVNode(a.Edit,null,null)]})]),e.createVNode("span",{class:"el-upload-list__item-icon",onClick:()=>(e=>{n.value.splice(e,1),v()})(i),title:"删除"},[e.createVNode(l.ElIcon,null,{default:()=>[e.createVNode(a.Delete,null,null)]})])])])])}),[[e.resolveDirective("loading"),p.value]]),x.preview&&e.createVNode(l.ElImageViewer,{closeOnPressEscape:!0,hideOnClickModal:!0,teleported:!0,onClose:()=>x.preview=!1,urlList:x.previewList},null)])),i.useExpose(s,{abort:e.computed(()=>{var e;return null==(e=y.value)?void 0:e.abort}),submit:e.computed(()=>{var e;return null==(e=y.value)?void 0:e.submit}),clearFiles:e.computed(()=>{var e;return null==(e=y.value)?void 0:e.clearFiles}),handleStart:e.computed(()=>{var e;return null==(e=y.value)?void 0:e.handleStart}),handleRemove:e.computed(()=>{var e;return null==(e=y.value)?void 0:e.handleRemove}),loading:p,fileList:n,preview:e.computed(()=>x.preview),previewList:e.computed(()=>x.previewList)})}});exports.default=s,exports.faUploadImagesEmits=d,exports.faUploadImagesProps=u;
//# sourceMappingURL=uploadImages.js.map
