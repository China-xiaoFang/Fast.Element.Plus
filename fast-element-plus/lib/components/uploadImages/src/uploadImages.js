"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),l=require("element-plus"),a=require("@element-plus/icons-vue"),t=require("../../upload/src/useUpload.js");require("../../../constants/index.js");const i=require("@fast-china/utils"),o=require("lodash-unified"),r=require("../../../constants/mime.js"),d={...l.uploadProps,accept:{type:String,default:()=>r.FaMimeType.Image},listType:{type:i.definePropType(String),default:"picture-card"},multiple:{type:Boolean,default:!0},limit:{type:Number,default:9},modelValue:i.definePropType([Array]),maxSize:{type:[String,Number],default:2048},uploadApi:{type:i.definePropType(Function)},uploadUrl:String},u={"update:modelValue":e=>o.isArray(e)||o.isNull(e),"update:fileList":e=>o.isArray(e),change:e=>o.isArray(e)||o.isNull(e)},s=e.defineComponent({name:"FaUploadImages",props:d,emits:u,slots:i.makeSlots(),setup(o,{attrs:r,slots:d,emit:u,expose:s}){const{fileList:n,loading:p,formContext:c,maxSizeMB:m,handleValue:v,handleHttpRequest:f,handleOnSuccess:g,handleOnError:N,handleOnExceed:V,handleOnUpload:h}=t.useUpload("FaUploadImages","图片",o,u,{maxSize:o.maxSize,uploadApi:o.uploadApi,uploadUrl:o.uploadUrl}),x=e.computed(()=>o.disabled||c?.disabled),y=e.reactive({uploadKey:`fa-upload-images__${i.stringUtil.generateRandomString(8)}`,preview:!1,previewIndex:-1,previewList:[]}),_=e.ref(),S=()=>{const e=document.querySelector(`.${y.uploadKey} .el-upload__input`);e&&e.dispatchEvent(new MouseEvent("click"))},w=e=>!!h(e)&&(!o.beforeUpload||o.beforeUpload(e)),E=i.useProps(o,l.uploadProps,["fileList","disabled","httpRequest","beforeUpload","onExceed","onSuccess","onError"]);return i.useRender(()=>e.createVNode(e.Fragment,null,[e.withDirectives(e.createVNode(l.ElUpload,e.mergeProps(E.value,{ref:_,class:["fa-upload-images",y.uploadKey,{"fa-upload-images__hidden-upload":n.value.length>=o.limit}],fileList:n.value,"onUpdate:fileList":e=>n.value=e,disabled:x.value,httpRequest:f,beforeUpload:w,onExceed:V,onSuccess:g,onError:N}),{default:()=>n.value.length<o.limit&&d.default?d.default():e.createVNode(l.ElIcon,null,{default:()=>[e.createVNode(a.Plus,null,null)]}),tip:()=>e.createVNode("div",{class:"el-upload__tip"},[e.createTextVNode("files with a size less than "),m.toString(),e.createTextVNode("MB")]),file:({file:t,index:i})=>e.createVNode("div",null,[e.createVNode("img",{class:"el-upload-list__item-thumbnail",src:t.url},null),e.createVNode("span",{class:"el-upload-list__item-actions"},[e.createVNode("span",{class:"el-upload-list__item-preview",onClick:()=>{return e=t,y.previewIndex=n.value.findIndex(l=>l.url===e.url),y.previewList=n.value.map(e=>e.url),void(y.preview=!0);var e},title:"查看"},[e.createVNode(l.ElIcon,null,{default:()=>[e.createVNode(a.ZoomIn,null,null)]})]),!x.value&&e.createVNode(e.Fragment,null,[e.createVNode("span",{class:"el-upload-list__item-icon",onClick:S,title:"编辑"},[e.createVNode(l.ElIcon,null,{default:()=>[e.createVNode(a.Edit,null,null)]})]),e.createVNode("span",{class:"el-upload-list__item-icon",onClick:()=>(e=>{n.value.splice(e,1),v()})(i),title:"删除"},[e.createVNode(l.ElIcon,null,{default:()=>[e.createVNode(a.Delete,null,null)]})])])])])}),[[e.resolveDirective("loading"),p.value]]),y.preview&&e.createVNode(l.ElImageViewer,{closeOnPressEscape:!0,hideOnClickModal:!0,teleported:!0,onClose:()=>y.preview=!1,urlList:y.previewList},null)])),i.useExpose(s,{abort:e.computed(()=>_.value?.abort),submit:e.computed(()=>_.value?.submit),clearFiles:e.computed(()=>_.value?.clearFiles),handleStart:e.computed(()=>_.value?.handleStart),handleRemove:e.computed(()=>_.value?.handleRemove),loading:p,fileList:n,preview:e.computed(()=>y.preview),previewList:e.computed(()=>y.previewList)})}});exports.default=s,exports.faUploadImagesEmits=u,exports.faUploadImagesProps=d;
//# sourceMappingURL=uploadImages.js.map
