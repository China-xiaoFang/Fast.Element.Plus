"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),l=require("@element-plus/icons-vue"),t=require("../../upload/src/useUpload.js");require("../../../constants/index.js");const a=require("../../../settings/index.js");require("../../../utils/index.js");const i=require("element-plus"),r=require("lodash-unified"),s=require("../../../constants/mime.js"),u=require("../../../utils/vue/props.js"),o=require("../../../utils/vue/slots.js"),d=require("../../../utils/string.js"),n=require("../../../utils/vue/useRender.js"),p=require("../../../utils/vue/expose.js"),c={...i.uploadProps,accept:{type:String,default:()=>s.FaMimeType.Image},listType:{type:u.definePropType(String),default:"picture-card"},multiple:{type:Boolean,default:!0},limit:{type:Number,default:9},modelValue:u.definePropType([String,Array]),maxSize:{type:u.definePropType([String,Number]),default:2048},uploadUrl:{type:String,default:()=>a.FastApp.state.upload.url},fileType:Number},v={"update:modelValue":e=>r.isString(e)||r.isArray(e),"update:fileList":e=>r.isArray(e),change:e=>r.isString(e)||r.isArray(e)},m=e.defineComponent({name:"FaUploadImages",props:c,emits:v,slots:o.makeSlots(),setup(a,{attrs:r,slots:s,emit:o,expose:c}){const{fileList:v,loading:m,formContext:f,maxSizeMB:g,handleValue:V,handleHttpRequest:x,handleOnSuccess:N,handleOnError:h,handleOnExceed:S,handleOnUpload:y}=t.useUpload("FaUploadImages","图片",a,o,{maxSize:a.maxSize,uploadUrl:a.uploadUrl}),_=e.computed((()=>a.disabled||(null==f?void 0:f.disabled))),b=e.reactive({uploadKey:`fa-upload-images__${d.stringUtil.generateRandomString(8)}`,preview:!1,previewIndex:-1,previewList:[]}),q=e.ref(),w=()=>{const e=document.querySelector(`.${b.uploadKey} .el-upload__input`);e&&e.dispatchEvent(new MouseEvent("click"))},E=e=>!!y(e)&&(!a.beforeUpload||a.beforeUpload(e)),U=u.useProps(a,i.uploadProps,["fileList","disabled","httpRequest","beforeUpload","onExceed","onSuccess","onError"]);return n.useRender((()=>e.createVNode(e.Fragment,null,[e.withDirectives(e.createVNode(i.ElUpload,e.mergeProps(U.value,{ref:q,class:["fa-upload-images",b.uploadKey,{"fa-upload-images__hidden-upload":v.value.length>=a.limit}],fileList:v.value,"onUpdate:fileList":e=>v.value=e,disabled:_.value,httpRequest:x,beforeUpload:E,onExceed:S,onSuccess:N,onError:h}),{default:()=>v.value.length<a.limit&&s.default?s.default():e.createVNode(i.ElIcon,null,{default:()=>[e.createVNode(l.Plus,null,null)]}),tip:()=>e.createVNode("div",{class:"el-upload__tip"},[e.createTextVNode("files with a size less than "),g.toString(),e.createTextVNode("MB")]),file:({file:t,index:a})=>e.createVNode("div",null,[e.createVNode("img",{class:"el-upload-list__item-thumbnail",src:t.url},null),e.createVNode("span",{class:"el-upload-list__item-actions"},[e.createVNode("span",{class:"el-upload-list__item-preview",onClick:()=>{return e=t,b.previewIndex=v.value.findIndex((l=>l.url===e.url)),b.previewList=v.value.map((e=>e.url)),void(b.preview=!0);var e},title:"查看"},[e.createVNode(i.ElIcon,null,{default:()=>[e.createVNode(l.ZoomIn,null,null)]})]),!_.value&&e.createVNode(e.Fragment,null,[e.createVNode("span",{class:"el-upload-list__item-icon",onClick:w,title:"编辑"},[e.createVNode(i.ElIcon,null,{default:()=>[e.createVNode(l.Edit,null,null)]})]),e.createVNode("span",{class:"el-upload-list__item-icon",onClick:()=>(e=>{v.value.splice(e,1),V()})(a),title:"删除"},[e.createVNode(i.ElIcon,null,{default:()=>[e.createVNode(l.Delete,null,null)]})])])])])}),[[e.resolveDirective("loading"),m.value]]),b.preview?e.createVNode(i.ElImageViewer,{closeOnPressEscape:!0,hideOnClickModal:!0,teleported:!0,onClose:()=>b.preview=!1,urlList:b.previewList},null):null]))),p.useExpose(c,{...e.computed((()=>{var e,l,t,a,i;return{abort:null==(e=q.value)?void 0:e.abort,submit:null==(l=q.value)?void 0:l.submit,clearFiles:null==(t=q.value)?void 0:t.clearFiles,handleStart:null==(a=q.value)?void 0:a.handleStart,handleRemove:null==(i=q.value)?void 0:i.handleRemove}})).value,loading:m,fileList:v,preview:b.preview,previewList:b.previewList})}});exports.default=m,exports.faUploadImagesEmits=v,exports.faUploadImagesProps=c;
//# sourceMappingURL=uploadImages.js.map
