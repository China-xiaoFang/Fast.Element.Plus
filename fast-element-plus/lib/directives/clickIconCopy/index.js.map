{"version":3,"file":"index.js","sources":["../../../../packages/directives/clickIconCopy/index.ts"],"sourcesContent":["/**\n * v-iconCopy\n * 左侧插入复制图标，复制某个值至剪贴板\n * 接收参数：string类型/Ref<string>类型/Reactive<string>类型\n */\nimport { type Directive, type DirectiveBinding, h, render } from \"vue\";\nimport { CopyDocument } from \"@element-plus/icons-vue\";\nimport { consoleError, stringUtil, withInstallDirective } from \"@fast-element-plus/utils\";\nimport { ElIcon, ElMessage } from \"element-plus\";\n\ninterface ElType extends HTMLElement {\n\tcopyData: string | number;\n\t__iconElement__: Node;\n}\n\nconst IconCopyDirective: Directive = {\n\tmounted(el: ElType, binding: DirectiveBinding) {\n\t\tel.copyData = binding.value;\n\n\t\tif (!el.copyData) return;\n\n\t\tconst handleCopyClick = async (): Promise<void> => {\n\t\t\ttry {\n\t\t\t\tawait stringUtil.copy(String(el.copyData));\n\t\t\t\tElMessage({\n\t\t\t\t\ttype: \"success\",\n\t\t\t\t\tmessage: \"复制成功\",\n\t\t\t\t});\n\t\t\t} catch (error) {\n\t\t\t\tElMessage({\n\t\t\t\t\ttype: \"error\",\n\t\t\t\t\tmessage: \"复制失败\",\n\t\t\t\t});\n\t\t\t\tconsoleError(\"CopyDirective\", \"复制失败\", error);\n\t\t\t}\n\t\t};\n\n\t\t// 创建 ELIcon 组件\n\t\tconst iconEl = h(\n\t\t\tElIcon,\n\t\t\t{\n\t\t\t\tclass: \"fa-icon-CopyDocument\",\n\t\t\t\ttitle: \"复制\",\n\t\t\t\tonClick: handleCopyClick,\n\t\t\t},\n\t\t\t{\n\t\t\t\tdefault: () => h(CopyDocument),\n\t\t\t}\n\t\t);\n\n\t\tconst tempDiv = document.createElement(\"div\");\n\t\trender(iconEl, tempDiv);\n\n\t\tel.__iconElement__ = tempDiv.firstChild;\n\t\tel.parentElement.insertBefore(tempDiv.firstChild, el);\n\t},\n\tupdated(el: ElType, binding: DirectiveBinding) {\n\t\tel.copyData = binding.value;\n\t},\n\tbeforeUnmount(el: ElType) {\n\t\tif (el.__iconElement__) {\n\t\t\tel.parentElement.removeChild(el.__iconElement__);\n\t\t}\n\t},\n};\n\nexport const vIconCopy = withInstallDirective(IconCopyDirective, \"iconCopy\");\nexport default vIconCopy;\n"],"names":["IconCopyDirective","mounted","el","binding","copyData","value","iconEl","h","ElIcon","class","title","onClick","async","stringUtil","copy","String","ElMessage","type","message","error","consoleError","default","CopyDocument","tempDiv","document","createElement","__iconElement__","firstChild","parentElement","insertBefore","updated","beforeUnmount","removeChild","vIconCopy","withInstallDirective"],"mappings":"uVAeMA,EAA+B,CACpC,OAAAC,CAAQC,EAAYC,GAGf,GAFJD,EAAGE,SAAWD,EAAQE,OAEjBH,EAAGE,SAAU,OAElB,MAiBME,EAASC,EAAAA,EACdC,EAAAA,OACA,CACCC,MAAO,uBACPC,MAAO,KACPC,QAtBsBC,UACnB,UACGC,EAAAA,WAAWC,KAAKC,OAAOb,EAAGE,WACtBY,YAAA,CACTC,KAAM,UACNC,QAAS,eAEFC,GACEH,YAAA,CACTC,KAAM,QACNC,QAAS,SAEGE,EAAAA,aAAA,gBAAiB,OAAQD,EACvC,IAWA,CACCE,QAAS,IAAMd,EAAAA,EAAEe,kBAIbC,EAAUC,SAASC,cAAc,gBAChCnB,EAAQiB,GAEfrB,EAAGwB,gBAAkBH,EAAQI,WAC7BzB,EAAG0B,cAAcC,aAAaN,EAAQI,WAAYzB,EACnD,EACA,OAAA4B,CAAQ5B,EAAYC,GACnBD,EAAGE,SAAWD,EAAQE,KACvB,EACA,aAAA0B,CAAc7B,GACTA,EAAGwB,iBACHxB,EAAA0B,cAAcI,YAAY9B,EAAGwB,gBAElC,GAGYO,EAAYC,EAAAA,qBAAqBlC,EAAmB"}