"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const e=require("../settings/index.js");require("./index.js");const o=require("./base64.js"),r=require("./console.js"),t="fast__",s="__Expire",n={set(n,i,a,c){try{if(c??(c=e.fastOptions.storageCrypto),a){if(isNaN(a)||a<1)throw new Error("有效期应为一个有效数值");const e={time:Date.now(),expire:a},o=JSON.stringify(e);window.localStorage.setItem(`${t}${n}${s}`,o)}let r=JSON.stringify(i);c&&(r=o.base64Util.toBase64(r)),window.localStorage.setItem(`${t}${n}`,r)}catch(l){r.consoleError("Local",l)}},get(n,i){try{i??(i=e.fastOptions.storageCrypto);let r=window.localStorage.getItem(`${t}${n}`);if(r){i&&(r=o.base64Util.base64ToStr(r));const e=window.localStorage.getItem(`${t}${n}${s}`);if(e){const o=JSON.parse(e);if(Date.now()>o.time+60*o.expire*1e3)return window.localStorage.removeItem(`${t}${n}`),window.localStorage.removeItem(`${t}${n}${s}`),null}try{return JSON.parse(r)}catch{return r}}return null}catch(a){r.consoleError("Local",a)}},remove(e){try{window.localStorage.removeItem(`${t}${e}`),window.localStorage.removeItem(`${t}${e}${s}`)}catch(o){r.consoleError("Local",o)}},removeByPrefix(e){try{for(const o in window.localStorage)-1!==o.indexOf(`${t}${e}`)&&window.localStorage.removeItem(o)}catch(o){r.consoleError("Local",o)}},clear(){try{window.localStorage.clear()}catch(e){r.consoleError("Local",e)}}},i={set(n,i,a,c){try{if(c??(c=e.fastOptions.storageCrypto),a){if(isNaN(a)||a<1)throw new Error("有效期应为一个有效数值");const e={time:Date.now(),expire:a},o=JSON.stringify(e);window.sessionStorage.setItem(`${t}${n}${s}`,o)}let r=JSON.stringify(i);c&&(r=o.base64Util.toBase64(r)),window.sessionStorage.setItem(`${t}${n}`,r)}catch(l){r.consoleError("Session",l)}},get(n,i){try{i??(i=e.fastOptions.storageCrypto);let r=window.sessionStorage.getItem(`${t}${n}`);if(r){i&&(r=o.base64Util.base64ToStr(r));const e=window.sessionStorage.getItem(`${t}${n}${s}`);if(e){const o=JSON.parse(e);if(Date.now()>o.time+60*o.expire*1e3)return window.sessionStorage.removeItem(`${t}${n}`),window.sessionStorage.removeItem(`${t}${n}${s}`),null}try{return JSON.parse(r)}catch{return r}}return null}catch(a){r.consoleError("Session",a)}},remove(e){try{window.sessionStorage.removeItem(`${t}${e}`),window.sessionStorage.removeItem(`${t}${e}${s}`)}catch(o){r.consoleError("Session",o)}},removeByPrefix(e){try{for(const o in window.sessionStorage)-1!==o.indexOf(`${t}${e}`)&&window.sessionStorage.removeItem(o)}catch(o){r.consoleError("Session",o)}},clear(){try{window.sessionStorage.clear()}catch(e){r.consoleError("Session",e)}}};exports.CACHE_EXPIRE_SUFFIX=s,exports.CACHE_PREFIX=t,exports.Local=n,exports.Session=i;
//# sourceMappingURL=storage.js.map
