"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const e=require("../settings/index.js");require("./index.js");const o=require("./base64.js"),t=require("./console.js"),r="fast__",s="__Expire",n={set(n,a,i,c){try{if(c??(c=e.FastApp.state.storageCrypto),i){if(isNaN(i)||i<1)throw new Error("有效期应为一个有效数值");const e={time:Date.now(),expire:i},o=JSON.stringify(e);window.localStorage.setItem(`${r}${n}${s}`,o)}let t=JSON.stringify(a);c&&(t=o.base64Util.toBase64(t)),window.localStorage.setItem(`${r}${n}`,t)}catch(l){t.consoleError("Local",l)}},get(n,a){try{a??(a=e.FastApp.state.storageCrypto);let t=window.localStorage.getItem(`${r}${n}`);if(t){a&&(t=o.base64Util.base64ToStr(t));const e=window.localStorage.getItem(`${r}${n}${s}`);if(e){const o=JSON.parse(e);if(Date.now()>o.time+60*o.expire*1e3)return window.localStorage.removeItem(`${r}${n}`),window.localStorage.removeItem(`${r}${n}${s}`),null}try{return JSON.parse(t)}catch{return t}}return null}catch(i){t.consoleError("Local",i)}},remove(e){try{window.localStorage.removeItem(`${r}${e}`),window.localStorage.removeItem(`${r}${e}${s}`)}catch(o){t.consoleError("Local",o)}},removeByPrefix(e){try{for(const o in window.localStorage)-1!==o.indexOf(`${r}${e}`)&&window.localStorage.removeItem(o)}catch(o){t.consoleError("Local",o)}},clear(){try{window.localStorage.clear()}catch(e){t.consoleError("Local",e)}}},a={set(n,a,i,c){try{if(c??(c=e.FastApp.state.storageCrypto),i){if(isNaN(i)||i<1)throw new Error("有效期应为一个有效数值");const e={time:Date.now(),expire:i},o=JSON.stringify(e);window.sessionStorage.setItem(`${r}${n}${s}`,o)}let t=JSON.stringify(a);c&&(t=o.base64Util.toBase64(t)),window.sessionStorage.setItem(`${r}${n}`,t)}catch(l){t.consoleError("Session",l)}},get(n,a){try{a??(a=e.FastApp.state.storageCrypto);let t=window.sessionStorage.getItem(`${r}${n}`);if(t){a&&(t=o.base64Util.base64ToStr(t));const e=window.sessionStorage.getItem(`${r}${n}${s}`);if(e){const o=JSON.parse(e);if(Date.now()>o.time+60*o.expire*1e3)return window.sessionStorage.removeItem(`${r}${n}`),window.sessionStorage.removeItem(`${r}${n}${s}`),null}try{return JSON.parse(t)}catch{return t}}return null}catch(i){t.consoleError("Session",i)}},remove(e){try{window.sessionStorage.removeItem(`${r}${e}`),window.sessionStorage.removeItem(`${r}${e}${s}`)}catch(o){t.consoleError("Session",o)}},removeByPrefix(e){try{for(const o in window.sessionStorage)-1!==o.indexOf(`${r}${e}`)&&window.sessionStorage.removeItem(o)}catch(o){t.consoleError("Session",o)}},clear(){try{window.sessionStorage.clear()}catch(e){t.consoleError("Session",e)}}};exports.CACHE_EXPIRE_SUFFIX=s,exports.CACHE_PREFIX=r,exports.Local=n,exports.Session=a;
//# sourceMappingURL=storage.js.map
